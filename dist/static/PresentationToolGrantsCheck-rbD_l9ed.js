const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/QRCodeSVG-slRtwL8X.js","static/sanity-A9RyJu9K.js","static/LiveQueries-Cph-vp_o.js","static/DisplayedDocumentBroadcaster-Cc8gmVaG.js","static/PostMessageDocuments-OWvj-XH5.js","static/PostMessageRefreshMutations-BtNeKtZK.js","static/PostMessagePerspective-C26xHE66.js","static/PostMessagePreviewSnapshots-CQHVXI5c.js","static/PostMessageSchema-Drz__zGm.js","static/PostMessageTelemetry-7QbbMorF.js"])))=>i.map(i=>d[i]);
import{r as f,aV as Dt,aW as Ur,j as l,aX as Lr,aY as _t,aZ as Qt,a_ as ut,a$ as ee,b0 as Or,at as wt,b1 as dt,b2 as Jt,b3 as jt,b4 as zr,b5 as Wr,b6 as yt,b7 as Dr,b8 as Nr,b9 as Et,ba as Rt,bb as Ne,bc as Be,bd as Ct,be as Tt,bf as He,bg as kt,bh as At,au as Yt,bi as Fr,bj as Zt,bk as Vr,bl as Br,a as W,bm as te,bn as er,bo as Kr,u as nt,bp as tr,bq as rr,aa as qe,n as st,o as be,br as xe,bs as nr,bt as sr,bu as Hr,bv as ar,bw as qr,bx as Gr,by as ir,bz as Ye,bA as bt,bB as or,a3 as Xr,bC as Qr,bD as Jr,F as ae,bE as Yr,ay as It,bF as Zr,bG as he,bH as at,bI as en,bJ as tn,bK as rn,bL as nn,bM as sn,L as ve,bN as Mt,bO as $t,bP as an,bQ as Nt,bR as on,K as Ut,bS as cn,bT as ln,C as pe,bU as cr,bV as Ge,af as Re,p as Ze,T as re,S as Ue,a0 as et,m as tt,ah as Ce,bW as un,bX as dn,bY as pn,bZ as mn,I as hn,t as ge,b as fn,b_ as it,b$ as gn,c0 as ot,c1 as vn,c2 as wn,G as yn,c3 as Ke,c4 as lr,c5 as bn,c6 as xn,z as Pn,c7 as Sn,J as _n,c8 as jn,c9 as En,ca as ur,aj as Rn,cb as Cn,cc as Tn,cd as kn,aL as An,x as In,ce as Mn,ao as dr,cf as $n,a4 as pr,aM as mr,as as Un,cg as Ln,ch as On,ci as zn,cj as Wn,ck as Dn,cl as Nn,cm as Fn,cn as Vn}from"./sanity-A9RyJu9K.js";import{D as Bn,i as Kn}from"./DisplayedDocumentBroadcaster-Cc8gmVaG.js";function Hn({children:t,isValidProp:e,...r}){e&&Lr(e),r={...f.useContext(Dt),...r},r.isStatic=Ur(()=>r.isStatic);const s=f.useMemo(()=>r,[JSON.stringify(r.transition),r.transformPagePoint,r.reducedMotion]);return l.jsx(Dt.Provider,{value:s,children:t})}const se=[];for(let t=0;t<256;++t)se.push((t+256).toString(16).slice(1));function qn(t,e=0){return(se[t[e+0]]+se[t[e+1]]+se[t[e+2]]+se[t[e+3]]+"-"+se[t[e+4]]+se[t[e+5]]+"-"+se[t[e+6]]+se[t[e+7]]+"-"+se[t[e+8]]+se[t[e+9]]+"-"+se[t[e+10]]+se[t[e+11]]+se[t[e+12]]+se[t[e+13]]+se[t[e+14]]+se[t[e+15]]).toLowerCase()}let pt;const Gn=new Uint8Array(16);function Xn(){if(!pt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");pt=crypto.getRandomValues.bind(crypto)}return pt(Gn)}const Qn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ft={randomUUID:Qn};function Jn(t,e,r){var a;if(Ft.randomUUID&&!t)return Ft.randomUUID();t=t||{};const s=t.random??((a=t.rng)==null?void 0:a.call(t))??Xn();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,qn(s)}const Yn=t=>e=>{const{data:r}=e;return(t.include.length?t.include.includes(r.type):!0)&&(t.exclude.length?!t.exclude.includes(r.type):!0)&&r.domain===t.domain&&r.from===t.from&&r.to===t.to&&(!t.target||e.source===t.target)},Zn=t=>e=>({type:t,message:e}),es=Or(()=>yt(window,"message")),ts=t=>Qt(({input:e})=>es.pipe(t?wt(t):dt(),Jt(Yn(e)),wt(Zn(e.responseType)),e.count?dt(Wr(e.count),zr(r=>r),jt(e.count)):dt())),hr="sanity/comlink",rs=3e3,Lt="comlink/response",fr="comlink/heartbeat",gr="comlink/disconnect",vr="comlink/handshake/syn",wr="comlink/handshake/syn-ack",yr="comlink/handshake/ack",ns=t=>e=>e.pipe(jt(1),wt(()=>{throw new Error(t)})),ss=()=>_t({actors:{listen:Qt(({input:t})=>{const e=t.signal?yt(t.signal,"abort").pipe(ns(`Request ${t.requestId} aborted`)):Dr,r=s=>{var a,n;return((a=s.data)==null?void 0:a.type)===Lt&&((n=s.data)==null?void 0:n.responseTo)===t.requestId&&!!s.source&&t.sources.has(s.source)};return yt(window,"message").pipe(Jt(r),jt(t.sources.size),Nr(e))})},actions:{"send message":({context:t},e)=>{const{sources:r,targetOrigin:s}=t,{message:a}=e;r.forEach(n=>{n.postMessage(a,{targetOrigin:s})})},"on success":ut(({context:t})=>t.parentRef,({context:t,self:e})=>{var r;return t.response&&((r=t.resolvable)==null||r.resolve(t.response)),{type:"request.success",requestId:e.id,response:t.response,responseTo:t.responseTo}}),"on fail":ut(({context:t})=>t.parentRef,({context:t,self:e})=>{var r;return t.suppressWarnings||console.warn(`[@sanity/comlink] Received no response to message '${t.type}' on client '${t.from}' (ID: '${t.id}').`),(r=t.resolvable)==null||r.reject(new Error("No response received")),{type:"request.failed",requestId:e.id}}),"on abort":ut(({context:t})=>t.parentRef,({context:t,self:e})=>{var r;return(r=t.resolvable)==null||r.reject(new Error("Request aborted")),{type:"request.aborted",requestId:e.id}})},guards:{expectsResponse:({context:t})=>t.expectResponse},delays:{initialTimeout:0,responseTimeout:({context:t})=>t.responseTimeout??rs}}).createMachine({context:({input:t})=>({channelId:t.channelId,data:t.data,domain:t.domain,expectResponse:t.expectResponse??!1,from:t.from,id:`msg-${Jn()}`,parentRef:t.parentRef,resolvable:t.resolvable,response:null,responseTimeout:t.responseTimeout,responseTo:t.responseTo,signal:t.signal,sources:t.sources instanceof Set?t.sources:new Set([t.sources]),suppressWarnings:t.suppressWarnings,targetOrigin:t.targetOrigin,to:t.to,type:t.type}),initial:"idle",on:{abort:".aborted"},states:{idle:{after:{initialTimeout:[{target:"sending"}]}},sending:{entry:{type:"send message",params:({context:t})=>{const{channelId:e,data:r,domain:s,from:a,id:n,responseTo:i,to:o,type:c}=t;return{message:{channelId:e,data:r,domain:s,from:a,id:n,to:o,type:c,responseTo:i}}}},always:[{guard:"expectsResponse",target:"awaiting"},"success"]},awaiting:{invoke:{id:"listen for response",src:"listen",input:({context:t})=>({requestId:t.id,sources:t.sources,signal:t.signal}),onError:"aborted"},after:{responseTimeout:"failed"},on:{message:{actions:ee({response:({event:t})=>t.data.data,responseTo:({event:t})=>t.data.responseTo}),target:"success"}}},failed:{type:"final",entry:"on fail"},success:{type:"final",entry:"on success"},aborted:{type:"final",entry:"on abort"}},output:({context:t,self:e})=>({requestId:e.id,response:t.response,responseTo:t.responseTo})}),as={"handshake/syn":vr,"handshake/syn-ack":wr,"handshake/ack":yr,"channel/response":Lt,"channel/heartbeat":fr,"channel/disconnect":gr,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},is={[vr]:"handshake/syn",[wr]:"handshake/syn-ack",[yr]:"handshake/ack",[Lt]:"channel/response",[fr]:"channel/heartbeat",[gr]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},os=t=>{const{data:e}=t;return e&&typeof e=="object"&&"domain"in e&&"type"in e&&"from"in e&&"to"in e&&(e.domain==="sanity/channels"&&(e.domain=hr),e.to==="overlays"&&(e.to="visual-editing"),e.from==="overlays"&&(e.from="visual-editing"),e.channelId=e.connectionId,delete e.connectionId,e.type=as[e.type]??e.type),t},cs=t=>{const{channelId:e,...r}=t,s={...r,connectionId:e};return s.domain===hr&&(s.domain="sanity/channels"),s.to==="visual-editing"&&(s.to="overlays"),s.from==="visual-editing"&&(s.from="overlays"),s.type=is[s.type]??s.type,s.type==="channel/response"&&s.responseTo&&!s.data&&(s.data={responseTo:s.responseTo}),(s.type==="handshake/syn"||s.type==="handshake/syn-ack"||s.type==="handshake/ack")&&(s.data={id:s.connectionId}),s},ls=({context:t},e)=>{const{sources:r,targetOrigin:s}=t,a=cs(e.message);r.forEach(n=>{n.postMessage(a,{targetOrigin:s})})},xt=()=>({listen:ts(os),requestMachine:ss().provide({actions:{"send message":ls}})});function us(t){const e=new URL(t),{searchParams:r}=e;return r.delete(Et),r.delete(Rt),r.delete(Ne),r.delete(Be),r.delete(Ct),e}function ds(t,e,r,s){const a=new URL(t),{searchParams:n}=a;return e&&(n.set(Rt,e),n.set(Et,r)),n.set(Ne,s),a}function br(){if(typeof crypto<"u"){const t=new Uint8Array(16);crypto.getRandomValues(t);let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function ps(t,e,r,s){const a=t.withConfig({apiVersion:Tt}),n=br(),i=a.patch(He).set({secret:n,studioUrl:r,userId:s});return await a.transaction().createIfNotExists({_id:He,_type:kt,source:e,studioUrl:r,userId:s}).patch(i).commit({tag:At}),{secret:n}}async function ms(t,e,r,s){const a=t.withConfig({apiVersion:Tt}),n=a.patch(He).set({secret:null,studioUrl:r,userId:s});await a.transaction().createIfNotExists({_id:He,_type:kt,source:e,studioUrl:r,userId:s}).patch(n).commit({tag:At})}function hs(t){for(var e=[],r=0;r<t.length;){var s=t[r];if(s==="*"||s==="+"||s==="?"){e.push({type:"MODIFIER",index:r,value:t[r++]});continue}if(s==="\\"){e.push({type:"ESCAPED_CHAR",index:r++,value:t[r++]});continue}if(s==="{"){e.push({type:"OPEN",index:r,value:t[r++]});continue}if(s==="}"){e.push({type:"CLOSE",index:r,value:t[r++]});continue}if(s===":"){for(var a="",n=r+1;n<t.length;){var i=t.charCodeAt(n);if(i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||i===95){a+=t[n++];continue}break}if(!a)throw new TypeError("Missing parameter name at ".concat(r));e.push({type:"NAME",index:r,value:a}),r=n;continue}if(s==="("){var o=1,c="",n=r+1;if(t[n]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(n));for(;n<t.length;){if(t[n]==="\\"){c+=t[n++]+t[n++];continue}if(t[n]===")"){if(o--,o===0){n++;break}}else if(t[n]==="("&&(o++,t[n+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(n));c+=t[n++]}if(o)throw new TypeError("Unbalanced pattern at ".concat(r));if(!c)throw new TypeError("Missing pattern at ".concat(r));e.push({type:"PATTERN",index:r,value:c}),r=n;continue}e.push({type:"CHAR",index:r,value:t[r++]})}return e.push({type:"END",index:r,value:""}),e}function fs(t,e){e===void 0&&(e={});for(var r=hs(t),s=e.prefixes,a=s===void 0?"./":s,n=e.delimiter,i=n===void 0?"/#?":n,o=[],c=0,u=0,m="",d=function(C){if(u<r.length&&r[u].type===C)return r[u++].value},p=function(C){var R=d(C);if(R!==void 0)return R;var E=r[u],U=E.type,M=E.index;throw new TypeError("Unexpected ".concat(U," at ").concat(M,", expected ").concat(C))},h=function(){for(var C="",R;R=d("CHAR")||d("ESCAPED_CHAR");)C+=R;return C},b=function(C){for(var R=0,E=i;R<E.length;R++){var U=E[R];if(C.indexOf(U)>-1)return!0}return!1},w=function(C){var R=o[o.length-1],E=C||(R&&typeof R=="string"?R:"");if(R&&!E)throw new TypeError('Must have text between two parameters, missing text after "'.concat(R.name,'"'));return!E||b(E)?"[^".concat(Me(i),"]+?"):"(?:(?!".concat(Me(E),")[^").concat(Me(i),"])+?")};u<r.length;){var g=d("CHAR"),v=d("NAME"),P=d("PATTERN");if(v||P){var S=g||"";a.indexOf(S)===-1&&(m+=S,S=""),m&&(o.push(m),m=""),o.push({name:v||c++,prefix:S,suffix:"",pattern:P||w(S),modifier:d("MODIFIER")||""});continue}var y=g||d("ESCAPED_CHAR");if(y){m+=y;continue}m&&(o.push(m),m="");var x=d("OPEN");if(x){var S=h(),_=d("NAME")||"",T=d("PATTERN")||"",j=h();p("CLOSE"),o.push({name:_||(T?c++:""),pattern:_&&!T?w(S):T,prefix:S,suffix:j,modifier:d("MODIFIER")||""});continue}p("END")}return o}function gs(t,e){var r=[],s=Pr(t,r,e);return vs(s,r,e)}function vs(t,e,r){r===void 0&&(r={});var s=r.decode,a=s===void 0?function(n){return n}:s;return function(n){var i=t.exec(n);if(!i)return!1;for(var o=i[0],c=i.index,u=Object.create(null),m=function(p){if(i[p]===void 0)return"continue";var h=e[p-1];h.modifier==="*"||h.modifier==="+"?u[h.name]=i[p].split(h.prefix+h.suffix).map(function(b){return a(b,h)}):u[h.name]=a(i[p],h)},d=1;d<i.length;d++)m(d);return{path:o,index:c,params:u}}}function Me(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function xr(t){return t&&t.sensitive?"":"i"}function ws(t,e){if(!e)return t;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,s=0,a=r.exec(t.source);a;)e.push({name:a[1]||s++,prefix:"",suffix:"",modifier:"",pattern:""}),a=r.exec(t.source);return t}function ys(t,e,r){var s=t.map(function(a){return Pr(a,e,r).source});return new RegExp("(?:".concat(s.join("|"),")"),xr(r))}function bs(t,e,r){return xs(fs(t,r),e,r)}function xs(t,e,r){r===void 0&&(r={});for(var s=r.strict,a=s===void 0?!1:s,n=r.start,i=n===void 0?!0:n,o=r.end,c=o===void 0?!0:o,u=r.encode,m=u===void 0?function(R){return R}:u,d=r.delimiter,p=d===void 0?"/#?":d,h=r.endsWith,b=h===void 0?"":h,w="[".concat(Me(b),"]|$"),g="[".concat(Me(p),"]"),v=i?"^":"",P=0,S=t;P<S.length;P++){var y=S[P];if(typeof y=="string")v+=Me(m(y));else{var x=Me(m(y.prefix)),_=Me(m(y.suffix));if(y.pattern)if(e&&e.push(y),x||_)if(y.modifier==="+"||y.modifier==="*"){var T=y.modifier==="*"?"?":"";v+="(?:".concat(x,"((?:").concat(y.pattern,")(?:").concat(_).concat(x,"(?:").concat(y.pattern,"))*)").concat(_,")").concat(T)}else v+="(?:".concat(x,"(").concat(y.pattern,")").concat(_,")").concat(y.modifier);else{if(y.modifier==="+"||y.modifier==="*")throw new TypeError('Can not repeat "'.concat(y.name,'" without a prefix and suffix'));v+="(".concat(y.pattern,")").concat(y.modifier)}else v+="(?:".concat(x).concat(_,")").concat(y.modifier)}}if(c)a||(v+="".concat(g,"?")),v+=r.endsWith?"(?=".concat(w,")"):"$";else{var j=t[t.length-1],C=typeof j=="string"?g.indexOf(j[j.length-1])>-1:j===void 0;a||(v+="(?:".concat(g,"(?=").concat(w,"))?")),C||(v+="(?=".concat(g,"|").concat(w,")"))}return new RegExp(v,xr(r))}function Pr(t,e,r){return t instanceof RegExp?ws(t,e):Array.isArray(t)?ys(t,e,r):bs(t,e,r)}async function Ps(t,e,r,s,a=Yt()){const n=t.withConfig({apiVersion:Tt});try{const i=new Date(Date.now()+1e3*Fr),o=`drafts.${a}`,c=br(),u=n.patch(o).set({secret:c,source:e,studioUrl:r,userId:s});return await n.transaction().createOrReplace({_id:o,_type:Zt}).patch(u).commit({tag:At}),{secret:c,expiresAt:i}}finally{try{await n.delete({query:Vr})}catch(i){console.error("Failed to delete expired secrets",i)}}}function Ss(t,e){let r=new AbortController,s=[];async function a(i,o){const{result:c,syncTags:u}=await t.fetch(Br,{},{filterResponse:!1,lastLiveEventId:i,tag:"preview-url-secret.fetch-vercel-bypass-protection-secret"});Array.isArray(u)&&(s=u),o.aborted||e(c)}const n=t.live.events().subscribe({next:i=>{i.type==="message"&&(r.abort(),r=new AbortController,i.tags.some(o=>s.includes(o))&&a(i.id,r.signal))},error:i=>console.error(i)});return a(null,r.signal),()=>{n.unsubscribe(),r.abort()}}const _s=t=>{const e=W.c(3),{comlink:r}=t;let s,a;return e[0]!==r?(s=()=>r.on("visual-editing/features",Es),a=[r],e[0]=r,e[1]=s,e[2]=a):(s=e[1],a=e[2]),f.useEffect(s,a),null};var js=f.memo(_s);function Es(){return{features:{optimistic:!0}}}const Rs=_t({actions:{},actors:{},guards:{}}).createMachine({id:"Presentation Tool",context:{url:null,error:null,visualEditingOverlaysEnabled:!1},on:{"iframe reload":{actions:ee({url:null}),target:".loading"}},states:{error:{description:"Failed to load, either because of a misconfiguration, a network error, or an unexpected error",tags:["error"]},loading:{on:{"iframe loaded":{target:"loaded"}},tags:["busy"]},loaded:{on:{"toggle visual editing overlays":{actions:ee({visualEditingOverlaysEnabled:({event:t})=>t.enabled})},"iframe refresh":{target:".refreshing"},"iframe reload":{target:".reloading"}},states:{idle:{},refreshing:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]},reloading:{on:{"iframe loaded":{target:"idle"}},tags:["busy"]}},initial:"idle"}},initial:"loading"}),Cs=function(t){const e=W.c(14),{comlink:r,children:s}=t;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={},e[0]=a):a=e[0];const n=f.useRef(a);let i,o;e[1]!==r?(i=()=>r==null?void 0:r.on("visual-editing/shared-state",()=>({state:n.current})),o=[r],e[1]=r,e[2]=i,e[3]=o):(i=e[2],o=e[3]),f.useEffect(i,o);let c;e[4]!==r?(c=(g,v)=>{n.current[g]=v,r==null||r.post("presentation/shared-state",{key:g,value:v})},e[4]=r,e[5]=c):c=e[5];const u=c;let m;e[6]!==r?(m=g=>{r==null||r.post("presentation/shared-state",{key:g}),delete n.current[g]},e[6]=r,e[7]=m):m=e[7];const d=m;let p,h;e[8]!==d||e[9]!==u?(h={removeValue:d,setValue:u},e[8]=d,e[9]=u,e[10]=h):h=e[10],p=h;const b=p;let w;return e[11]!==s||e[12]!==b?(w=l.jsx(sn.Provider,{value:b,children:s}),e[11]=s,e[12]=b,e[13]=w):w=e[13],w},Ts=ve.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Ot=function(t){const e=W.c(15),{children:r,defaultSize:s,id:a,minWidth:n,maxWidth:i,order:o}=t,c=s===void 0?null:s,u=o===void 0?0:o,m=f.useContext(Mt);if(m===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:d,registerElement:p,unregisterElement:h}=m;let b;e[0]!==d||e[1]!==a?(b=d(a),e[0]=d,e[1]=a,e[2]=b):b=e[2];const w=b;let g,v;e[3]!==c||e[4]!==a||e[5]!==i||e[6]!==n||e[7]!==u||e[8]!==p||e[9]!==h?(g=()=>(p(a,{id:a,type:"panel",defaultSize:c,maxWidth:i??null,minWidth:n??0,order:u}),()=>{h(a)}),v=[a,c,u,i,n,p,h],e[3]=c,e[4]=a,e[5]=i,e[6]=n,e[7]=u,e[8]=p,e[9]=h,e[10]=g,e[11]=v):(g=e[10],v=e[11]),f.useLayoutEffect(g,v);let P;return e[12]!==r||e[13]!==w?(P=l.jsx(Ts,{style:w,children:r}),e[12]=r,e[13]=w,e[14]=P):P=e[14],P};function Sr(t,e){let r;return(...s)=>{clearTimeout(r),r=setTimeout(()=>{t.apply(t,s)},e)}}const _r="presentation/panels",jr=()=>JSON.parse(localStorage.getItem(_r)||"{}"),ks=t=>{localStorage.setItem(_r,JSON.stringify(t))},Er=t=>t.map(e=>[e.id,e.order].join(":")).join(",");function As(){const t=W.c(1);let e;const r=Ms,s=Is;let a;if(t[0]===Symbol.for("react.memo_cache_sentinel")){const n=Sr(s,100);a={get:r,set:s,setDebounced:n},t[0]=a}else a=t[0];return e=a,e}function Is(t,e){const r=jr(),s=Er(t),a={...r,[s]:e};ks(a)}function Ms(t){const e=jr(),r=Er(t);return Array.isArray(e[r])&&e[r].some($s)?void 0:e[r]}function $s(t){return t===null}function Pt(t,e,r){const{maxWidth:s,minWidth:a}=t,n=s==null?100:s/r*100,i=a/r*100;return Math.min(n,Math.max(i,e))}function Us(t,e,r,s,a,n){const{panels:i,widths:o}=a,{widths:c}=n,u=c||o,m=[...u];{const b=t<0?s:r,w=i.findIndex(P=>P.id===b.id),g=u[w],v=Pt(b,g+Math.abs(t),e);if(g===v)return u;t=t<0?g-v:v-g}let d=0,p=t<0?r:s,h=i.findIndex(b=>b.id===p.id);for(;;){const b=i[h],w=u[h],g=Math.abs(t)-Math.abs(d),v=Pt(b,w-g,e);if(w!==v&&(d+=w-v,m[h]=v,d.toPrecision(10).localeCompare(Math.abs(t).toPrecision(10),void 0,{numeric:!0})>=0))break;if(t<0){if(--h<0)break}else if(++h>=i.length)break}return d===0?u:(p=t<0?s:r,h=i.findIndex(b=>b.id===p.id),m[h]=u[h]+d,m)}function Ls(t,e,r){if(t.length===1)return"100";const s=t.findIndex(n=>n.id===e),a=r[s];return a==null?"0":a.toPrecision(10)}function Vt(t,e,r=0,s=null){const a=t.clientX,n=(s||e.getBoundingClientRect()).left;return a-n-r}function mt(t){return t.type==="panel"}function Bt(t){return t.type==="resizer"}function Kt(t){return Array.from(t.values()).sort(({order:e},{order:r})=>e==null&&r==null?0:e==null?-1:r==null?1:e-r)}function Ht(t,e,r){const s=e.reduce((i,o)=>i+o,0),a=[...e].map(i=>i/s*100);let n=0;for(let i=0;i<t.length;i++){const o=t[i],c=a[i],u=Pt(o,c,r);c!=u&&(n+=c-u,a[i]=u)}if(n.toFixed(3)!=="0.000")for(let i=0;i<t.length;i++){const o=t[i];let{maxWidth:c,minWidth:u}=o;u=u/r*100,c!=null&&(c=c/r*100);const m=Math.min(c??100,Math.max(u,a[i]+n));if(m!==a[i]&&(n-=m-a[i],a[i]=m,Math.abs(n).toFixed(3)==="0.000"))break}return a}function Os(t){let e=t.length,r=100;const s=t.map(n=>n.defaultSize?(r-=n.defaultSize,e-=1,n.defaultSize):null),a=r/e;return s.map(n=>n===null?a:n)}const zs=ve.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Ws=function(t){const e=W.c(46),{children:r}=t,s=f.useRef(null);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=new Map,e[0]=a):a=e[0];const[n,i]=f.useState(a);let o,c;e[1]!==n?(c=Kt(n).filter(mt),e[1]=n,e[2]=c):c=e[2],o=c;const u=o;let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=[],e[3]=m):m=e[3];const[d,p]=f.useState(m),[h,b]=f.useState(null);let w;e[4]!==n||e[5]!==u||e[6]!==d?(w={elements:n,panels:u,widths:d},e[4]=n,e[5]=u,e[6]=d,e[7]=w):w=e[7];const g=f.useRef(w);let v;e[8]!==h||e[9]!==u||e[10]!==d?(v=F=>({flexGrow:Ls(u,F,d),pointerEvents:h===null?void 0:"none"}),e[8]=h,e[9]=u,e[10]=d,e[11]=v):v=e[11];const P=v;let S;e[12]===Symbol.for("react.memo_cache_sentinel")?(S=(F,K)=>{i(H=>{if(H.has(F))return H;const J=new Map(H);return J.set(F,K),J})},e[12]=S):S=e[12];const y=S;let x;e[13]===Symbol.for("react.memo_cache_sentinel")?(x=F=>{i(K=>{if(!K.has(F))return K;const H=new Map(K);return H.delete(F),H})},e[13]=x):x=e[13];const _=x;let T;e[14]===Symbol.for("react.memo_cache_sentinel")?(T={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=T):T=e[14];const j=f.useRef(T);let C;e[15]!==n?(C=(F,K)=>{const H=Kt(n),J=H.findIndex(N=>N.id===F),$=n.get(F);if(!$||!Bt($))return;const V=$.el.current;V&&(j.current={resizerIndex:J,panelBefore:H.reduce((N,Z,le)=>mt(Z)&&le<J?Z:N,null),panelAfter:H.reduce((N,Z,le)=>N===null&&mt(Z)&&le>J?Z:N,null),containerWidth:window.innerWidth,startX:K.pageX,dragOffset:Vt(K,V),resizerRect:V.getBoundingClientRect(),widths:g.current.widths},b(F))},e[15]=n,e[16]=C):C=e[16];const R=C;let E;e[17]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{b(null)},e[17]=E):E=e[17];const U=E;let M;e[18]!==n?(M=(F,K)=>{K.preventDefault(),K.stopPropagation();const{containerWidth:H,dragOffset:J,panelBefore:$,panelAfter:V,resizerRect:N}=j.current;if($==null||V==null)return;const Z=n.get(F);if(!Z||!Bt(Z))return;const le=Z.el.current;if(!le)return;const me=Vt(K,le,J,N);if(me===0)return;const{widths:Te}=g.current,Pe=s.current.getBoundingClientRect(),Se=me/Pe.width*100,fe=Us(Se,H,$,V,g.current,j.current);Te.some((_e,we)=>_e!==fe[we])&&p(fe)},e[18]=n,e[19]=M):M=e[19];const k=M;let A,z;e[20]!==n||e[21]!==u||e[22]!==d?(A=()=>{g.current.elements=n,g.current.panels=u,g.current.widths=d},z=[n,u,d],e[20]=n,e[21]=u,e[22]=d,e[23]=A,e[24]=z):(A=e[23],z=e[24]),f.useLayoutEffect(A,z);const D=As();let B,X;e[25]!==u||e[26]!==D?(B=()=>{const{widths:F}=g.current;if(F.length===u.length)return;const K=D.get(u);if(K){const J=Ht(u,K,window.innerWidth);p(J);return}const H=Os(u);p(H)},X=[D,u],e[25]=u,e[26]=D,e[27]=B,e[28]=X):(B=e[27],X=e[28]),f.useLayoutEffect(B,X);let ie,q;e[29]!==u||e[30]!==D||e[31]!==d?(ie=()=>{d.length&&D.setDebounced(u,d)},q=[D,u,d],e[29]=u,e[30]=D,e[31]=d,e[32]=ie,e[33]=q):(ie=e[32],q=e[33]),f.useEffect(ie,q);let G,ue;e[34]===Symbol.for("react.memo_cache_sentinel")?(G=()=>{const F=new ResizeObserver(()=>{const{panels:K,widths:H}=g.current,J=Ht(K,H,window.innerWidth);H.some(($,V)=>$!==J[V])&&p(J)});return F.observe(s.current),()=>{F.disconnect()}},ue=[],e[34]=G,e[35]=ue):(G=e[34],ue=e[35]),f.useLayoutEffect(G,ue);let Q,ne;e[36]!==h||e[37]!==k||e[38]!==P||e[39]!==R?(ne={activeResizer:h,drag:k,getPanelStyle:P,registerElement:y,startDragging:R,stopDragging:U,unregisterElement:_},e[36]=h,e[37]=k,e[38]=P,e[39]=R,e[40]=ne):ne=e[40],Q=ne;const oe=Q;let Y;e[41]!==r?(Y=l.jsx(zs,{ref:s,children:r}),e[41]=r,e[42]=Y):Y=e[42];let ce;return e[43]!==oe||e[44]!==Y?(ce=l.jsx(Mt.Provider,{value:oe,children:Y}),e[43]=oe,e[44]=Y,e[45]=ce):ce=e[45],ce};function zt(t){const e=W.c(37);let r,s,a,n,i;e[0]!==t?({children:r,message:s,onRetry:n,onContinueAnyway:a,...i}=t,e[0]=t,e[1]=r,e[2]=s,e[3]=a,e[4]=n,e[5]=i):(r=e[1],s=e[2],a=e[3],n=e[4],i=e[5]);const{t:o}=be(xe);let c;e[6]!==o?(c=o("error-card.retry-button.text"),e[6]=o,e[7]=c):c=e[7];let u;e[8]!==n||e[9]!==c?(u=l.jsx(Re,{mode:"ghost",onClick:n,text:c}),e[8]=n,e[9]=c,e[10]=u):u=e[10];const m=u;let d;e[11]!==o?(d=o("error-card.continue-button.text"),e[11]=o,e[12]=d):d=e[12];let p;e[13]!==a||e[14]!==d?(p=l.jsx(Re,{mode:"ghost",tone:"critical",onClick:a,text:d}),e[13]=a,e[14]=d,e[15]=p):p=e[15];const h=p;let b;e[16]!==o?(b=o("error-card.title"),e[16]=o,e[17]=b):b=e[17];let w;e[18]!==b?(w=l.jsx(re,{size:1,weight:"semibold",children:b}),e[18]=b,e[19]=w):w=e[19];let g;e[20]!==s?(g=l.jsx(re,{muted:!0,size:1,children:s}),e[20]=s,e[21]=g):g=e[21];let v;e[22]!==w||e[23]!==g?(v=l.jsxs(Ue,{space:3,children:[w,g]}),e[22]=w,e[23]=g,e[24]=v):v=e[24];let P;e[25]!==h||e[26]!==a||e[27]!==n||e[28]!==m?(P=n&&a?l.jsxs(hn,{space:2,children:[m,h]}):n?l.jsx(ge,{children:m}):a?l.jsx(ge,{children:h}):null,e[25]=h,e[26]=a,e[27]=n,e[28]=m,e[29]=P):P=e[29];let S;e[30]!==r||e[31]!==v||e[32]!==P?(S=l.jsx(ae,{align:"center",height:"fill",justify:"center",children:l.jsx(fn,{padding:4,sizing:"border",width:0,children:l.jsxs(Ue,{space:4,children:[v,r,P]})})}),e[30]=r,e[31]=v,e[32]=P,e[33]=S):S=e[33];let y;return e[34]!==i||e[35]!==S?(y=l.jsx(pe,{height:"fill",...i,children:S}),e[34]=i,e[35]=S,e[36]=y):y=e[36],y}function Ds(t={}){const e=Object.entries(t).map(([r,s])=>`${r}=${s}`).join("&");return e.length?`?${e}`:""}function Ns(t){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],r=Object.entries(t).filter(([s])=>e.includes(s)).reduce((s,[a,n])=>n==null?s:{...s,[a]:n},{});return Ds(r)}const Fs=f.forwardRef(function(t,e){const r=W.c(11);let s,a;r[0]!==t?({searchParams:a,...s}=t,r[0]=t,r[1]=s,r[2]=a):(s=r[1],a=r[2]);let n;r[3]!==a?(n=Object.entries(a),r[3]=a,r[4]=n):n=r[4];let i;r[5]!==n?(i={type:void 0,_searchParams:n},r[5]=n,r[6]=i):i=r[6];let o;return r[7]!==e||r[8]!==s||r[9]!==i?(o=l.jsx(it,{...s,ref:e,state:i,title:void 0}),r[7]=e,r[8]=s,r[9]=i,r[10]=o):o=r[10],o}),Vs=f.forwardRef(function(t,e){const r=W.c(15);let s,a,n,i;if(r[0]!==t){const{documentId:m,documentType:d,parentRefPath:p,template:h,searchParams:b,...w}=t;s=m,a=d,i=b,n=w,r[0]=t,r[1]=s,r[2]=a,r[3]=n,r[4]=i}else s=r[1],a=r[2],n=r[3],i=r[4];let o;r[5]!==i?(o=Object.entries(i),r[5]=i,r[6]=o):o=r[6];let c;r[7]!==s||r[8]!==a||r[9]!==o?(c={id:s,type:a,_searchParams:o},r[7]=s,r[8]=a,r[9]=o,r[10]=c):c=r[10];let u;return r[11]!==e||r[12]!==n||r[13]!==c?(u=l.jsx(it,{...n,ref:e,state:c,title:void 0}),r[11]=e,r[12]=n,r[13]=c,r[14]=u):u=r[14],u});function Rr(t){const e=W.c(26),{children:r,onStructureParams:s,structureParams:a,searchParams:n,refs:i}=t,{state:o,resolvePathFromState:c}=qe();let u;e[0]!==o._searchParams?(u=Object.fromEntries(o._searchParams||[]),e[0]=o._searchParams,e[1]=u):u=e[1];const m=ar(u);let d;e[2]!==c||e[3]!==m||e[4]!==o?(d=j=>{const C=c(o),R=Ns({...m,...j});return`${C}${R}`},e[2]=c,e[3]=m,e[4]=o,e[5]=d):d=e[5];const p=d;let h,b;e[6]===Symbol.for("react.memo_cache_sentinel")?(b={},e[6]=b):b=e[6];const w=a;let g;e[7]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[7]=g):g=e[7];let v;e[8]!==i||e[9]!==n?(v=j=>{const{childId:C,...R}=j,E=i==null?void 0:i.find(U=>U._id===C||at(U._id)===C);return E?l.jsx(it,{...R,state:{id:C,type:E._type,_searchParams:Object.entries(n)}}):l.jsx("div",{...R})},e[8]=i,e[9]=n,e[10]=v):v=e[10];let P,S;e[11]!==n?(P=j=>l.jsx(Fs,{...j,searchParams:n}),S=j=>l.jsx(Vs,{...j,searchParams:n}),e[11]=n,e[12]=P,e[13]=S):(P=e[12],S=e[13]);let y;e[14]!==s?(y=j=>{s({...j,inspect:j.inspect??void 0})},e[14]=s,e[15]=y):y=e[15];let x;e[16]!==p||e[17]!==w||e[18]!==v||e[19]!==P||e[20]!==S||e[21]!==y?(x={index:0,groupIndex:0,siblingIndex:0,payload:b,params:w,hasGroupSiblings:!1,groupLength:1,routerPanesState:g,ChildLink:v,BackLink:P,ReferenceChildLink:S,ParameterizedLink:Ys,closeCurrentAndAfter:Js,handleEditReference:Qs,replaceCurrent:Xs,closeCurrent:Gs,duplicateCurrent:qs,setView:Hs,setParams:y,setPayload:Ks,navigateIntent:Bs,createPathWithParams:p},e[16]=p,e[17]=w,e[18]=v,e[19]=P,e[20]=S,e[21]=y,e[22]=x):x=e[22],h=x;const _=h;let T;return e[23]!==r||e[24]!==_?(T=l.jsx(Un.Provider,{value:_,children:r}),e[23]=r,e[24]=_,e[25]=T):T=e[25],T}function Bs(t,e,r){console.warn("navigateIntent",t,e,r)}function Ks(t){console.warn("setPayload",t)}function Hs(t){console.warn("setView",t)}function qs(t){console.warn("duplicateCurrent",t)}function Gs(){console.warn("closeCurrent")}function Xs(t){console.warn("replaceCurrent",t)}function Qs(t){console.warn("handleEditReference",t)}function Js(){console.warn("closeCurrentAndAfter")}function Ys(){throw new Error("ParameterizedLink not implemented")}const Zs=ve(mr)`
  height: 100%;
`,ea=ve(ae)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,ta=ve(tt)`
  white-space: pre-wrap;
`;function ra(t){var C,R,E,U;const e=W.c(33),{mainDocumentState:r,onStructureParams:s,searchParams:a,refs:n}=t,{t:i}=be(xe),{devMode:o}=$t();let c,u;if(e[0]!==((C=r==null?void 0:r.document)==null?void 0:C._id)||e[1]!==n){let M;e[3]!==((R=r==null?void 0:r.document)==null?void 0:R._id)?(M=k=>{var A;return at(k._id)!==((A=r==null?void 0:r.document)==null?void 0:A._id)},e[3]=(E=r==null?void 0:r.document)==null?void 0:E._id,e[4]=M):M=e[4],u=n.filter(M).map(sa),e[0]=(U=r==null?void 0:r.document)==null?void 0:U._id,e[1]=n,e[2]=u}else u=e[2];c=u;const m=c;let d,p;e[5]!==m?(p={filter:"_id in $ids",params:{ids:m}},e[5]=m,e[6]=p):p=e[6];let h;e[7]!==i?(h=i("document-list-pane.document-list.title"),e[7]=i,e[8]=h):h=e[8];let b;e[9]!==p||e[10]!==h?(b={id:"$root",options:p,schemaTypeName:"",title:h,type:"documentList"},e[9]=p,e[10]=h,e[11]=b):b=e[11],d=b;const w=d,[g,v]=f.useState(null);let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=()=>v(null),e[12]=P):P=e[12];const S=P,[y]=f.useState(na);let x;e[13]===Symbol.for("react.memo_cache_sentinel")?(x=()=>v(null),e[13]=x):x=e[13];let _;if(e[14]!==n?(_=[n],e[14]=n,e[15]=_):_=e[15],f.useEffect(x,_),g){let M;e[16]!==i?(M=i("document-list-pane.error.text"),e[16]=i,e[17]=M):M=e[17];let k;e[18]!==o||e[19]!==g||e[20]!==i?(k=o&&l.jsx(pe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:i("presentation-error.label")}),l.jsx(ta,{size:1,children:g.error.message})]})}),e[18]=o,e[19]=g,e[20]=i,e[21]=k):k=e[21];let A;return e[22]!==k||e[23]!==M?(A=l.jsx(zt,{flex:1,message:M,onRetry:S,children:k}),e[22]=k,e[23]=M,e[24]=A):A=e[24],A}let T;e[25]!==w?(T=l.jsx(ea,{direction:"column",flex:1,children:l.jsx(Vn,{index:0,itemId:"$root",pane:w,paneKey:"$root"})}),e[25]=w,e[26]=T):T=e[26];let j;return e[27]!==s||e[28]!==n||e[29]!==a||e[30]!==y||e[31]!==T?(j=l.jsx(pr,{onCatch:v,children:l.jsx(Zs,{children:l.jsx(dr,{children:l.jsx(Rr,{onStructureParams:s,structureParams:y,searchParams:a,refs:n,children:T})})})}),e[27]=s,e[28]=n,e[29]=a,e[30]=y,e[31]=T,e[32]=j):j=e[32],j}function na(){return{}}function sa(t){return at(t._id)}const aa=ve(tt)`
  white-space: pre-wrap;
`;function ia(t){const e=W.c(35),{documentId:r,documentType:s,onFocusPath:a,onStructureParams:n,searchParams:i,structureParams:o}=t,{template:c,templateParams:u}=o,{t:m}=be(xe),{devMode:d}=$t();let p,h;e[0]!==u?(h=$n(u),e[0]=u,e[1]=h):h=e[1];let b;e[2]!==r||e[3]!==s||e[4]!==h||e[5]!==c?(b={id:r,type:s,template:c,templateParameters:h},e[2]=r,e[3]=s,e[4]=h,e[5]=c,e[6]=b):b=e[6];let w;e[7]!==r||e[8]!==b?(w={id:r,options:b,title:"",type:"document"},e[7]=r,e[8]=b,e[9]=w):w=e[9],p=w;const g=p,[v,P]=f.useState(null);let S;e[10]===Symbol.for("react.memo_cache_sentinel")?(S=()=>P(null),e[10]=S):S=e[10];const y=S;let x;e[11]===Symbol.for("react.memo_cache_sentinel")?(x=()=>{P(null)},e[11]=x):x=e[11];let _;if(e[12]!==r||e[13]!==s||e[14]!==o?(_=[r,s,o],e[12]=r,e[13]=s,e[14]=o,e[15]=_):_=e[15],f.useEffect(x,_),v){let E;e[16]!==m?(E=m("document-pane.error.text"),e[16]=m,e[17]=E):E=e[17];let U;e[18]!==d||e[19]!==v||e[20]!==m?(U=d&&l.jsx(pe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:m("presentation-error.label")}),l.jsx(aa,{size:1,children:v.error.message})]})}),e[18]=d,e[19]=v,e[20]=m,e[21]=U):U=e[21];let M;return e[22]!==E||e[23]!==U?(M=l.jsx(zt,{flex:1,message:E,onRetry:y,children:U}),e[22]=E,e[23]=U,e[24]=M):M=e[24],M}let T;e[25]===Symbol.for("react.memo_cache_sentinel")?(T={height:"100%"},e[25]=T):T=e[25];let j;e[26]===Symbol.for("react.memo_cache_sentinel")?(j=l.jsx(er,{}),e[26]=j):j=e[26];let C;e[27]!==a||e[28]!==g?(C=l.jsx(f.Suspense,{fallback:j,children:l.jsx(Ln,{paneKey:"document",index:1,itemId:"document",pane:g,onFocusPath:a})}),e[27]=a,e[28]=g,e[29]=C):C=e[29];let R;return e[30]!==n||e[31]!==i||e[32]!==o||e[33]!==C?(R=l.jsx(pr,{onCatch:P,children:l.jsx(mr,{style:T,children:l.jsx(Rr,{searchParams:i,onStructureParams:n,structureParams:o,children:C})})}),e[30]=n,e[31]=i,e[32]=o,e[33]=C,e[34]=R):R=e[34],R}function oa(t){const e=W.c(7),{documentId:r,documentType:s,onFocusPath:a,onStructureParams:n,searchParams:i,structureParams:o}=t;let c;return e[0]!==r||e[1]!==s||e[2]!==a||e[3]!==n||e[4]!==i||e[5]!==o?(c=l.jsx(dr,{children:l.jsx(ia,{documentId:r,documentType:s,onFocusPath:a,onStructureParams:n,searchParams:i,structureParams:o})}),e[0]=r,e[1]=s,e[2]=a,e[3]=n,e[4]=i,e[5]=o,e[6]=c):c=e[6],c}function ca(t,e){const r=W.c(7),s=Mn();let a;r[0]===Symbol.for("react.memo_cache_sentinel")?(a={},r[0]=a):a=r[0];const[n,i]=f.useState(a),{perspectiveStack:o}=It();let c,u;return r[1]!==t||r[2]!==s||r[3]!==o||r[4]!==e?(c=()=>{if(!e)return;const m=On(s,e,t,o).subscribe(d=>{i(d)});return()=>{m==null||m.unsubscribe()}},u=[s,e,t,o],r[1]=t,r[2]=s,r[3]=o,r[4]=e,r[5]=c,r[6]=u):(c=r[5],u=r[6]),f.useEffect(c,u),n}function la(t){var T,j,C,R,E,U,M,k;const e=W.c(38),{documentId:r,documentType:s,mainDocumentState:a,onFocusPath:n,onStructureParams:i,refs:o,searchParams:c,structureParams:u}=t,{t:m}=be(xe),d=Rn();let p;e[0]!==((T=a==null?void 0:a.document)==null?void 0:T._id)||e[1]!==((j=a==null?void 0:a.document)==null?void 0:j._type)||e[2]!==c?(p=A=>{var z,D;return l.jsx(it,{...A,state:{id:(z=a==null?void 0:a.document)==null?void 0:z._id,type:(D=a==null?void 0:a.document)==null?void 0:D._type,_searchParams:Object.entries(c)}})},e[0]=(C=a==null?void 0:a.document)==null?void 0:C._id,e[1]=(R=a==null?void 0:a.document)==null?void 0:R._type,e[2]=c,e[3]=p):p=e[3];const h=p;let b,w;e[4]!==((E=a==null?void 0:a.document)==null?void 0:E._type)||e[5]!==d?(w=d.get(((U=a==null?void 0:a.document)==null?void 0:U._type)||"shoe"),e[4]=(M=a==null?void 0:a.document)==null?void 0:M._type,e[5]=d,e[6]=w):w=e[6],b=w;const g=b,v=ca(((k=a==null?void 0:a.document)==null?void 0:k._id)||"",g);let P;e:{if(!(a!=null&&a.document)){P=null;break e}let A;e[7]!==a.document||e[8]!==v.snapshot?(A=Cn({snapshot:v.snapshot,fallback:a.document}),e[7]=a.document,e[8]=v.snapshot,e[9]=A):A=e[9];let z;e[10]!==m?(z=m("main-document.label"),e[10]=m,e[11]=z):z=e[11];let D;e[12]!==z?(D=l.jsx(pe,{padding:1,radius:2,shadow:1,children:l.jsx(re,{muted:!0,size:0,weight:"medium",children:z})}),e[12]=z,e[13]=D):D=e[13];let B;e[14]!==g||e[15]!==A||e[16]!==D?(B=l.jsx(Tn,{...A,schemaType:g,status:D}),e[14]=g,e[15]=A,e[16]=D,e[17]=B):B=e[17],P=B}const S=P;if(r&&s){let A;return e[18]!==r||e[19]!==s||e[20]!==n||e[21]!==i||e[22]!==c||e[23]!==u?(A=l.jsx(oa,{documentId:r,documentType:s,onFocusPath:n,onStructureParams:i,searchParams:c,structureParams:u}),e[18]=r,e[19]=s,e[20]=n,e[21]=i,e[22]=c,e[23]=u,e[24]=A):A=e[24],A}let y;e[25]!==h||e[26]!==a||e[27]!==S||e[28]!==m?(y=a&&l.jsx(pe,{padding:3,tone:a.document?"inherit":"caution",children:a.document?l.jsx(kn,{__unstable_focusRing:!0,as:h,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:S}):l.jsx(pe,{padding:2,radius:2,tone:"inherit",children:l.jsxs(ae,{gap:3,children:[l.jsx(ge,{flex:"none",children:l.jsx(re,{size:1,children:l.jsx(An,{})})}),l.jsx(ge,{flex:1,children:l.jsx(re,{size:1,children:l.jsx(Ut,{t:m,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:a.path}})})})]})})}),e[25]=h,e[26]=a,e[27]=S,e[28]=m,e[29]=y):y=e[29];let x;e[30]!==a||e[31]!==i||e[32]!==o||e[33]!==c?(x=l.jsx(ra,{mainDocumentState:a,onStructureParams:i,searchParams:c,refs:o}),e[30]=a,e[31]=i,e[32]=o,e[33]=c,e[34]=x):x=e[34];let _;return e[35]!==y||e[36]!==x?(_=l.jsxs(ae,{direction:"column",flex:1,height:"fill",children:[y,x]}),e[35]=y,e[36]=x,e[37]=_):_=e[37],_}function ua(t){const e=W.c(2);let r;e[0]!==t?(r=()=>t||zn(),e[0]=t,e[1]=r):r=e[1];const[s]=f.useState(r);return s}const da=ve.div`
  position: relative;
`,pa=ve.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:t})=>t?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:t})=>!t&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,Cr=function(t){const e=W.c(27),{id:r,order:s,disabled:a}=t,n=a===void 0?!1:a,i=f.useRef(null),o=f.useContext(Mt);if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");const c=ua(r),{activeResizer:u,drag:m,startDragging:d,stopDragging:p,registerElement:h,unregisterElement:b}=o,w=u===c;if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");let g;e[0]!==c||e[1]!==d?(g=k=>{d(c,k.nativeEvent)},e[0]=c,e[1]=d,e[2]=g):g=e[2];const v=g;let P;e[3]!==m||e[4]!==c?(P=k=>{m(c,k)},e[3]=m,e[4]=c,e[5]=P):P=e[5];const S=P;let y;e[6]!==p?(y=()=>{i.current.blur(),p()},e[6]=p,e[7]=y):y=e[7];const x=y;let _,T;e[8]!==n||e[9]!==w||e[10]!==S||e[11]!==x?(_=()=>{if(!w||n)return;const k=function(){const A=document.body.style,z=document.documentElement.style,{cursor:D}=z,{userSelect:B}=A;return z.cursor="ew-resize",A.userSelect="none",()=>{D?z.cursor=D:z.removeProperty("cursor"),B?A.userSelect=B:A.removeProperty("user-select")}}();return window.addEventListener("mousemove",S),window.addEventListener("mouseup",x),window.addEventListener("contextmenu",x),()=>{k(),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",x),window.removeEventListener("contextmenu",x)}},T=[n,w,S,x],e[8]=n,e[9]=w,e[10]=S,e[11]=x,e[12]=_,e[13]=T):(_=e[12],T=e[13]),f.useEffect(_,T);let j,C;e[14]!==c||e[15]!==s||e[16]!==h||e[17]!==b?(j=()=>(h(c,{id:c,order:s,type:"resizer",el:i}),()=>{b(c)}),C=[c,s,h,b],e[14]=c,e[15]=s,e[16]=h,e[17]=b,e[18]=j,e[19]=C):(j=e[18],C=e[19]),f.useLayoutEffect(j,C);let R,E;e[20]===Symbol.for("react.memo_cache_sentinel")?(E=l.jsx("span",{}),R=l.jsx("span",{}),e[20]=R,e[21]=E):(R=e[20],E=e[21]);let U;e[22]!==n?(U=l.jsxs(pa,{$disabled:n,children:[E,R]}),e[22]=n,e[23]=U):U=e[23];let M;return e[24]!==v||e[25]!==U?(M=l.jsx(da,{onMouseDown:v,ref:i,children:U}),e[24]=v,e[25]=U,e[26]=M):M=e[26],M},ma=t=>{const e=W.c(8),{documentId:r,setDisplayedDocument:s,getCommentIntent:a}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=l.jsx(Cr,{order:4}),e[0]=n):n=e[0];let i;e[1]!==a||e[2]!==t.children?(i=l.jsx(un,{getIntent:a,children:t.children}),e[1]=a,e[2]=t.children,e[3]=i):i=e[3];let o;return e[4]!==r||e[5]!==s||e[6]!==i?(o=l.jsxs(l.Fragment,{children:[n,l.jsx(Ot,{id:"content",minWidth:325,order:5,children:l.jsx(Bn,{documentId:r,setDisplayedDocument:s,children:i})})]}),e[4]=r,e[5]=s,e[6]=i,e[7]=o):o=e[7],o},ha=t=>{const e=W.c(14),{documentId:r,documentsOnPage:s,documentType:a,getCommentIntent:n,mainDocumentState:i,onFocusPath:o,onStructureParams:c,searchParams:u,setDisplayedDocument:m,structureParams:d}=t;let p;e[0]!==r||e[1]!==a||e[2]!==s||e[3]!==i||e[4]!==o||e[5]!==c||e[6]!==u||e[7]!==d?(p=l.jsx(la,{documentId:r,documentType:a,mainDocumentState:i,onFocusPath:o,onStructureParams:c,refs:s,searchParams:u,structureParams:d}),e[0]=r,e[1]=a,e[2]=s,e[3]=i,e[4]=o,e[5]=c,e[6]=u,e[7]=d,e[8]=p):p=e[8];let h;return e[9]!==r||e[10]!==n||e[11]!==m||e[12]!==p?(h=l.jsx(ma,{documentId:r,getCommentIntent:n,setDisplayedDocument:m,children:p}),e[9]=r,e[10]=n,e[11]=m,e[12]=p,e[13]=h):h=e[13],h},fa=function(t){const e=W.c(5),{children:r,navigate:s}=t;let a;e[0]!==s?(a=(o,c)=>{s((c===void 0?void 0:c)||{},o?{preview:o}:{})},e[0]=s,e[1]=a):a=e[1];const n=a;let i;return e[2]!==r||e[3]!==n?(i=l.jsx(rn.Provider,{value:n,children:r}),e[2]=r,e[3]=n,e[4]=i):i=e[4],i};function ga(t,e){const r=W.c(9);let s;r[0]!==e||r[1]!==t?(s=()=>JSON.parse(localStorage.getItem(t)??JSON.stringify(e)),r[0]=e,r[1]=t,r[2]=s):s=r[2];const[a,n]=f.useState(s);let i,o;r[3]!==t||r[4]!==a?(i=()=>{localStorage.setItem(t,JSON.stringify(a))},o=[t,a],r[3]=t,r[4]=a,r[5]=i,r[6]=o):(i=r[5],o=r[6]),f.useEffect(i,o);let c;return r[7]!==a?(c=[a,n],r[7]=a,r[8]=c):c=r[8],c}function va(t){const e=W.c(11),{unstable_navigator:r}=t,s=!!(r!=null&&r.component),[a,n]=ga("presentation/navigator",s),i=s?a:!1;let o;e:{if(!s){o=void 0;break e}let h;e[0]!==n?(h=()=>n(wa),e[0]=n,e[1]=h):h=e[1],o=h}const c=o;let u;e[2]!==i||e[3]!==r?(u=function(){return l.jsx(l.Fragment,{children:i&&l.jsx(ba,{...r})})},e[2]=i,e[3]=r,e[4]=u):u=e[4];const m=u;let d;e[5]!==i||e[6]!==c?(d={navigatorEnabled:i,toggleNavigator:c},e[5]=i,e[6]=c,e[7]=d):d=e[7];let p;return e[8]!==m||e[9]!==d?(p=[d,m],e[8]=m,e[9]=d,e[10]=p):p=e[10],p}function wa(t){return!t}function ya(t){const e=W.c(11),{minWidth:r,maxWidth:s,component:a}=t,n=r!=null&&s!=null&&r===s;let i;e[0]!==a?(i=l.jsx(a,{}),e[0]=a,e[1]=i):i=e[1];let o;e[2]!==s||e[3]!==r||e[4]!==i?(o=l.jsx(Ot,{id:"navigator",minWidth:r,maxWidth:s,order:1,children:i}),e[2]=s,e[3]=r,e[4]=i,e[5]=o):o=e[5];let c;e[6]!==n?(c=l.jsx(Cr,{order:2,disabled:n}),e[6]=n,e[7]=c):c=e[7];let u;return e[8]!==o||e[9]!==c?(u=l.jsxs(l.Fragment,{children:[o,c]}),e[8]=o,e[9]=c,e[10]=u):u=e[10],u}const ba=f.memo(ya),xa=function(t){const e=W.c(3),{children:r,params:s}=t;let a;a=s;const n=a;let i;return e[0]!==r||e[1]!==n?(i=l.jsx(nn.Provider,{value:n,children:r}),e[0]=r,e[1]=n,e[2]=i):i=e[2],i},Pa=function(t){const e=W.c(10),{children:r,devMode:s,name:a,navigate:n,params:i,searchParams:o,structureParams:c}=t;let u,m;e[0]!==s||e[1]!==a||e[2]!==n||e[3]!==i||e[4]!==o||e[5]!==c?(m={devMode:s,name:a,navigate:n,params:i,searchParams:o,structureParams:c},e[0]=s,e[1]=a,e[2]=n,e[3]=i,e[4]=o,e[5]=c,e[6]=m):m=e[6],u=m;const d=u;let p;return e[7]!==r||e[8]!==d?(p=l.jsx(tn.Provider,{value:d,children:r}),e[7]=r,e[8]=d,e[9]=p):p=e[9],p};function Wt(t){const e=te(t,Sa);if(!Array.isArray(e))throw new TypeError("allowPatterns must be an array");return e}function Sa(t){return t.context.allowOrigins}function Fe(t){return Array.isArray(t)?t.join(","):t}function Tr(){const t=W.c(2),e=f.useId();let r;return t[0]!==e?(r=e.startsWith(":")?e.replace(/^:(.+):$/,"«$1»"):e,t[0]=e,t[1]=r):r=t[1],r}const _a=f.forwardRef(function(t,e){const r=W.c(19),{animate:s,initial:a,onLoad:n,preventClick:i,src:o,variants:c,style:u}=t,m=f.useRef(null);let d;r[0]===Symbol.for("react.memo_cache_sentinel")?(d=()=>m.current,r[0]=d):d=r[0],f.useImperativeHandle(e,d);let p,h;r[1]===Symbol.for("react.memo_cache_sentinel")?(p=()=>{if(!m.current)return;const y=m.current,x=function(){y===document.activeElement&&y.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))};return window.addEventListener("blur",x),()=>{window.removeEventListener("blur",x)}},h=[],r[1]=p,r[2]=h):(p=r[1],h=r[2]),f.useEffect(p,h);const b=Tr();let w;r[3]!==u||r[4]!==b?(w={...u,viewTransitionName:b},r[3]=u,r[4]=b,r[5]=w):w=r[5];let g;r[6]!==s||r[7]!==a||r[8]!==n||r[9]!==o||r[10]!==w||r[11]!==c?(g=l.jsx(ja,{style:w,animate:s,initial:a,onLoad:n,ref:m,src:o,variants:c}),r[6]=s,r[7]=a,r[8]=n,r[9]=o,r[10]=w,r[11]=c,r[12]=g):g=r[12];let v;r[13]!==i?(v=i&&l.jsx(Ea,{}),r[13]=i,r[14]=v):v=r[14];let P;r[15]===Symbol.for("react.memo_cache_sentinel")?(P=l.jsx(Ra,{}),r[15]=P):P=r[15];let S;return r[16]!==g||r[17]!==v?(S=l.jsxs(l.Fragment,{children:[g,v,P]}),r[16]=g,r[17]=v,r[18]=S):S=r[18],S}),ja=Ge.create(ve.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border: 0;
  max-height: 100%;
  width: 100%;
  view-transition-class: presentation-tool-iframe;
`),Ea=ve(ge)`
  position: absolute;
  inset: 0;
  background: transparent;
`,Ra=gn`
html:active-view-transition-type(sanity-iframe-viewport) {
  view-transition-name: none;
  &::view-transition {
    pointer-events: none;
  }
  /* &::view-transition-old(root) {
    display: none;
  }
  &::view-transition-new(root) {
    animation: none;
  } */
}
`;function Ca(t){const e=W.c(16),{openPopup:r,previewLocationOrigin:s,previewLocationRoute:a,perspective:n,targetOrigin:i}=t;let o;const c=new URL(a,s||i);c.searchParams.set(Ne,Fe(n));const{pathname:u,search:m}=c;o=`${s}${u}${m}`;const d=o,{t:p}=be(xe);let h;e[0]!==r?(h=x=>{x.preventDefault(),r(x.currentTarget.href)},e[0]=r,e[1]=h):h=e[1];const b=h;let w;e[2]!==p?(w=p("share-url.menu-item.open.text"),e[2]=p,e[3]=w):w=e[3];let g;e[4]!==w?(g=l.jsx(re,{size:1,children:w}),e[4]=w,e[5]=g):g=e[5];let v;e[6]===Symbol.for("react.memo_cache_sentinel")?(v=["bottom-start"],e[6]=v):v=e[6];let P;e[7]!==p?(P=p("share-url.menu-item.open.text"),e[7]=p,e[8]=P):P=e[8];let S;e[9]!==b||e[10]!==d||e[11]!==P?(S=l.jsx(Re,{as:"a","aria-label":P,icon:Wn,mode:"bleed",href:d,rel:"opener",target:"_blank",tooltipProps:null,onClick:b}),e[9]=b,e[10]=d,e[11]=P,e[12]=S):S=e[12];let y;return e[13]!==g||e[14]!==S?(y=l.jsx(Ke,{animate:!0,content:g,fallbackPlacements:v,placement:"bottom",portal:!0,children:S}),e[13]=g,e[14]=S,e[15]=y):y=e[15],y}function kr(t){const e=te(t,Ta);if(!e)throw new TypeError("targetOrigin is required");return e}function Ta(t){var e;return(e=t.context.previewUrl)==null?void 0:e.origin}function ka(t){var q;const e=W.c(32),{fontSize:r,onChange:s,padding:a,prefix:n,suffix:i,value:o,previewUrlRef:c}=t,u=r===void 0?1:r,m=a===void 0?3:a,d=Wt(c),p=kr(c),{t:h}=be(xe),{basePath:b}=((q=rr())==null?void 0:q.activeWorkspace)||{},w=b===void 0?"/":b,g=f.useRef(null),[v,P]=f.useState(void 0),[S,y]=f.useState(void 0);let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x=G=>{P(G.currentTarget.value)},e[0]=x):x=e[0];const _=x;let T;e[1]!==d||e[2]!==w||e[3]!==s||e[4]!==v||e[5]!==h||e[6]!==p?(T=G=>{var ue;if(G.key==="Enter"){if(v===void 0)return;let Q;Q=v;try{Q=new URL(v,p).toString()}catch{}if(Array.isArray(d)){if(!d.some(oe=>oe.test(Q))){y(h("preview-location-input.error",{origin:p,context:"origin-not-allowed"})),G.currentTarget.reportValidity();return}}else if(!p&&(Q.startsWith(`${w}/`)||Q===w)){y(h("preview-location-input.error",{basePath:w,context:"same-base-path"}));return}const ne=Q===p?`${p}/`:Q;y(void 0),P(void 0),s(ne),(ue=g.current)==null||ue.blur()}G.key==="Escape"&&(y(void 0),P(void 0))},e[1]=d,e[2]=w,e[3]=s,e[4]=v,e[5]=h,e[6]=p,e[7]=T):T=e[7];const j=T;let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=()=>{y(void 0),P(void 0)},e[8]=C):C=e[8];const R=C;let E;e[9]!==p||e[10]!==o?(E=()=>{y(void 0);let G=o;try{G=new URL(o,p).toString()}catch{}P(G)},e[9]=p,e[10]=o,e[11]=E):E=e[11];const U=E;let M;e[12]===Symbol.for("react.memo_cache_sentinel")?(M=()=>{y(void 0),P(void 0)},e[12]=M):M=e[12];let k;e[13]!==p||e[14]!==o?(k=[p,o],e[13]=p,e[14]=o,e[15]=k):k=e[15],f.useEffect(M,k);let A,z;e[16]===Symbol.for("react.memo_cache_sentinel")?(z={icon:Dn},e[16]=z):z=e[16],A=z;const D=S?A:void 0;let B;e[17]===Symbol.for("react.memo_cache_sentinel")?(B={zIndex:1},e[17]=B):B=e[17];let X;e[18]!==v||e[19]!==p||e[20]!==o?(X=v===void 0?new URL(o,p).toString():v,e[18]=v,e[19]=p,e[20]=o,e[21]=X):X=e[21];let ie;return e[22]!==S||e[23]!==u||e[24]!==U||e[25]!==j||e[26]!==m||e[27]!==n||e[28]!==i||e[29]!==D||e[30]!==X?(ie=l.jsx(l.Fragment,{children:l.jsx(In,{clearButton:D,customValidity:S,fontSize:u,onBlur:R,onClear:U,onChange:_,onKeyDownCapture:j,padding:m,prefix:n,style:B,radius:2,ref:g,space:m,suffix:i,value:X})}),e[22]=S,e[23]=u,e[24]=U,e[25]=j,e[26]=m,e[27]=n,e[28]=i,e[29]=D,e[30]=X,e[31]=ie):ie=e[31],ie}const Aa=f.lazy(()=>Ce(()=>import("./QRCodeSVG-slRtwL8X.js"),__vite__mapDeps([0,1]))),St=24,Ia=16,Ma=224,$a=ve(Nn)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${St}px;
  width: ${St}px;
`,Ua=Ge.create(Ze),La=Ge.create(re),Oa=Ge.create($a),Ar=f.memo(function(t){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:r,initialUrl:s,previewLocationRoute:a,perspective:n}=t,{t:i}=be(xe),{push:o}=st(),c=nt({apiVersion:ot}),u=tr(),[m,d]=f.useState(!0),[p,h]=f.useState(!1),[b,w]=f.useState(!1),[g,v]=f.useState(null),P=p||b||m,S=f.useMemo(()=>g?ds(s,g,a,Fe(n)):null,[s,n,a,g]),[y,x]=f.useState(null);if(y)throw y;const _=f.useCallback(()=>{o({closable:!0,status:"warning",title:i("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[o,i]),T=f.useCallback(async()=>{try{w(!0),await ms(c,"sanity/presentation",typeof window>"u"?"":location.href,u==null?void 0:u.id),v(null)}catch(R){x(R)}finally{w(!1)}},[c,u==null?void 0:u.id]),j=f.useCallback(async()=>{try{h(!0);const R=await ps(c,"sanity/presentation",typeof window>"u"?"":location.href,u==null?void 0:u.id);v(R.secret)}catch(R){x(R)}finally{h(!1)}},[c,u==null?void 0:u.id]),C=f.useCallback(()=>{try{if(!S)throw new Error("No URL to copy");navigator.clipboard.writeText(S.toString()),o({closable:!0,status:"success",title:i("share-url.clipboard.status",{context:"success"})})}catch(R){x(R)}},[o,i,S]);return f.useEffect(()=>{let R=new AbortController,E=[];async function U(k,A){const{result:z,syncTags:D}=await c.fetch(ur,{},{filterResponse:!1,lastLiveEventId:k,tag:"presentation.fetch-shared-access-secret"});Array.isArray(D)&&(E=D),A.aborted||v(z)}const M=c.live.events().subscribe({next:k=>{k.type==="message"&&(R.abort(),R=new AbortController,k.tags.some(A=>E.includes(A))&&U(k.id,R.signal))},error:x});return U(null,R.signal).finally(()=>d(!1)),()=>{M.unsubscribe(),R.abort()}},[c]),l.jsx(vn,{button:l.jsx(Re,{"aria-label":i("preview-frame.share-button.aria-label"),icon:Sn,mode:"bleed",tooltipProps:null}),id:"share-menu",menu:l.jsx(wn,{style:{maxWidth:248},padding:r?void 0:0,children:r?l.jsxs(l.Fragment,{children:[l.jsx("label",{style:{cursor:"pointer"},children:l.jsxs(yn,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[l.jsx(Ke,{animate:!0,content:l.jsx(re,{size:1,children:i("share-preview-menu.toggle-button.tooltip",{context:S?"disable":"enable"})}),fallbackPlacements:["bottom-start"],placement:"bottom",portal:!0,children:l.jsx(lr,{checked:p||S!==null&&!b,readOnly:p||b,indeterminate:m,onChange:e?S?T:j:_})}),l.jsx(re,{size:1,weight:"medium",children:i("share-preview-menu.toggle-button.label",{context:"first-line"})}),l.jsx("span",{}),l.jsx(re,{muted:!0,size:1,children:i("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),l.jsx(ge,{padding:3,paddingTop:2,children:l.jsxs(Ue,{space:3,children:[l.jsx(pe,{tone:P||!S?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx(cr,{children:P?l.jsx(Ua,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):S?l.jsx(l.Fragment,{children:l.jsxs(f.Suspense,{fallback:l.jsx(Ze,{}),children:[l.jsx(Aa,{title:i("share-preview-menu.qr-code.title",{url:S.toString()}),value:S.toString(),size:Ma,color:"var(--card-fg-color)",logoSize:St+Ia}),l.jsx(Oa,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):l.jsx(La,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i("share-preview-menu.qr-code.placeholder")})})}),l.jsx(re,{muted:!0,size:1,children:i("share-preview-menu.qr-code.instructions")})]})}),l.jsx(bn,{}),l.jsx(xn,{disabled:!S||b,icon:Pn,onClick:C,text:i("share-preview-menu.copy-url.text")})]}):l.jsx(pe,{padding:2,tone:"caution",radius:3,children:l.jsx(re,{style:{textWrap:"pretty"},children:i("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{constrainSize:!0,placement:"bottom",portal:!0}})});Ar.displayName="Memo(SharePreviewMenu)";const za=t=>{const e=W.c(107),{canSharePreviewAccess:r,canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:a,iframeRef:n,initialUrl:i,navigatorEnabled:o,onPathChange:c,onRefresh:u,openPopup:m,overlaysConnection:d,presentationRef:p,perspective:h,previewUrl:b,setViewport:w,targetOrigin:g,toggleNavigator:v,toggleOverlay:P,viewport:S,previewUrlRef:y}=t,{t:x}=be(xe);let _;e[0]!==w||e[1]!==S?(_=()=>w(S==="desktop"?"mobile":"desktop"),e[0]=w,e[1]=S,e[2]=_):_=e[2];const T=_;let j;j=g===location.origin?"":g;const C=j;let R;e[3]!==n||e[4]!==u||e[5]!==p||e[6]!==b||e[7]!==g?(R=()=>{u(()=>{n.current&&(p.send({type:"iframe reload"}),Object.assign(n.current,{src:`${g}${b||"/"}`}))})},e[3]=n,e[4]=u,e[5]=p,e[6]=b,e[7]=g,e[8]=R):R=e[8];const E=R,U=te(p,Na),M=te(p,Fa),k=te(p,Va),A=te(p,Ba),z=te(p,Ka);let D;const B=new URL(b||"/",g),{pathname:X,search:ie}=us(B);D=`${X}${ie}`;const q=D,G=Tr(),ue=te(y,Ha);let Q;e[9]===Symbol.for("react.memo_cache_sentinel")?(Q={width:"100%"},e[9]=Q):Q=e[9];let ne;e[10]!==o||e[11]!==x||e[12]!==v?(ne=v&&l.jsx(Re,{"aria-label":x("preview-frame.navigator.toggle-button.aria-label"),icon:dn,mode:"bleed",onClick:v,selected:o,tooltipProps:{content:l.jsx(re,{size:1,children:x("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],placement:"bottom"}}),e[10]=o,e[11]=x,e[12]=v,e[13]=ne):ne=e[13];let oe;e[14]===Symbol.for("react.memo_cache_sentinel")?(oe={whiteSpace:"nowrap"},e[14]=oe):oe=e[14];const Y=z?"disable":"enable";let ce;e[15]!==x||e[16]!==Y?(ce=x("preview-frame.overlay.toggle-button.tooltip",{context:Y}),e[15]=x,e[16]=Y,e[17]=ce):ce=e[17];let F;e[18]!==ce?(F=l.jsx(ge,{padding:1,children:l.jsx(re,{size:1,children:ce})}),e[18]=ce,e[19]=F):F=e[19];let K;e[20]===Symbol.for("react.memo_cache_sentinel")?(K=l.jsx(ge,{paddingY:1,children:l.jsx(_n,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[20]=K):K=e[20];let H;e[21]!==F?(H=l.jsxs(ae,{align:"center",style:oe,children:[F,K]}),e[21]=F,e[22]=H):H=e[22];let J;e[23]===Symbol.for("react.memo_cache_sentinel")?(J=["bottom-start"],e[23]=J):J=e[23];let $;e[24]===Symbol.for("react.memo_cache_sentinel")?($={lineHeight:0,borderRadius:999,userSelect:"none"},e[24]=$):$=e[24];const V=z?"transparent":void 0;let N;e[25]===Symbol.for("react.memo_cache_sentinel")?(N={margin:-4},e[25]=N):N=e[25];const Z=!M,le=U||d!=="connected";let me;e[26]!==z||e[27]!==Z||e[28]!==le||e[29]!==P?(me=l.jsx("div",{style:N,children:l.jsx(lr,{indeterminate:Z,checked:z,onChange:P,disabled:le})}),e[26]=z,e[27]=Z,e[28]=le,e[29]=P,e[30]=me):me=e[30];const Te=!z;let Pe;e[31]!==x?(Pe=x("preview-frame.overlay.toggle-button.text"),e[31]=x,e[32]=Pe):Pe=e[32];let Se;e[33]!==Te||e[34]!==Pe?(Se=l.jsx(ge,{children:l.jsx(re,{muted:Te,size:1,weight:"medium",children:Pe})}),e[33]=Te,e[34]=Pe,e[35]=Se):Se=e[35];let fe;e[36]!==me||e[37]!==Se?(fe=l.jsxs(ae,{align:"center",gap:3,children:[me,Se]}),e[36]=me,e[37]=Se,e[38]=fe):fe=e[38];let _e;e[39]!==V||e[40]!==fe?(_e=l.jsx(pe,{as:"label",flex:"none",padding:3,marginX:1,style:$,tone:V,children:fe}),e[39]=V,e[40]=fe,e[41]=_e):_e=e[41];let we;e[42]!==H||e[43]!==_e?(we=l.jsx(Ke,{animate:!0,content:H,fallbackPlacements:J,placement:"bottom",portal:!0,children:_e}),e[42]=H,e[43]=_e,e[44]=we):we=e[44];let ke;e[45]!==M||e[46]!==U||e[47]!==k||e[48]!==A||e[49]!==x?(ke=M?x("preview-frame.refresh-button.tooltip"):x("preview-frame.status",{context:U?"loading":k?"refreshing":A?"reloading":"unknown"}),e[45]=M,e[46]=U,e[47]=k,e[48]=A,e[49]=x,e[50]=ke):ke=e[50];let Ae;e[51]!==ke?(Ae=l.jsx(re,{size:1,children:ke}),e[51]=ke,e[52]=Ae):Ae=e[52];let $e;e[53]===Symbol.for("react.memo_cache_sentinel")?($e=["bottom-end"],e[53]=$e):$e=e[53];let Ee;e[54]!==x?(Ee=x("preview-frame.refresh-button.aria-label"),e[54]=x,e[55]=Ee):Ee=e[55];const Le=A||k||ue;let I;e[56]!==E||e[57]!==Ee||e[58]!==Le?(I=l.jsx(Re,{"aria-label":Ee,icon:jn,mode:"bleed",loading:Le,onClick:E,tooltipProps:null}),e[56]=E,e[57]=Ee,e[58]=Le,e[59]=I):I=e[59];let O;e[60]!==Ae||e[61]!==I?(O=l.jsx(ge,{padding:1,children:l.jsx(Ke,{animate:!0,content:Ae,fallbackPlacements:$e,placement:"bottom",portal:!0,children:I})}),e[60]=Ae,e[61]=I,e[62]=O):O=e[62];let L;e[63]!==m||e[64]!==h||e[65]!==C||e[66]!==q||e[67]!==g?(L=l.jsx(ge,{padding:1,children:l.jsx(Ca,{openPopup:m,previewLocationOrigin:C,previewLocationRoute:q,perspective:h,targetOrigin:g})}),e[63]=m,e[64]=h,e[65]=C,e[66]=q,e[67]=g,e[68]=L):L=e[68];let je;e[69]!==c||e[70]!==q||e[71]!==y||e[72]!==O||e[73]!==L?(je=l.jsx(ge,{flex:1,children:l.jsx(ka,{previewUrlRef:y,prefix:O,onChange:c,suffix:L,value:q})}),e[69]=c,e[70]=q,e[71]=y,e[72]=O,e[73]=L,e[74]=je):je=e[74];let de;e[75]!==G?(de=lt=>{lt==null||lt.style.setProperty("view-transition-name",G)},e[75]=G,e[76]=de):de=e[76];const Ve=S==="desktop"?"narrow":"full";let Ie;e[77]!==x||e[78]!==Ve?(Ie=x("preview-frame.viewport-button.tooltip",{context:Ve}),e[77]=x,e[78]=Ve,e[79]=Ie):Ie=e[79];let ye;e[80]!==Ie?(ye=l.jsx(re,{size:1,children:Ie}),e[80]=Ie,e[81]=ye):ye=e[81];let Xe;e[82]===Symbol.for("react.memo_cache_sentinel")?(Xe=["bottom-start"],e[82]=Xe):Xe=e[82];let Oe;e[83]!==x?(Oe=x("preview-frame.viewport-button.aria-label"),e[83]=x,e[84]=Oe):Oe=e[84];const ct=S==="desktop"?pn:mn;let ze;e[85]!==Oe||e[86]!==ct||e[87]!==T||e[88]!==S?(ze=l.jsx(Re,{"data-testid":"preview-viewport-toggle","data-viewport":S,"aria-label":Oe,icon:ct,mode:"bleed",onClick:T,tooltipProps:null}),e[85]=Oe,e[86]=ct,e[87]=T,e[88]=S,e[89]=ze):ze=e[89];let We;e[90]!==de||e[91]!==ye||e[92]!==ze?(We=l.jsx(ae,{align:"center",flex:"none",gap:1,children:l.jsx(Ke,{animate:!0,ref:de,content:ye,fallbackPlacements:Xe,placement:"bottom",portal:!0,children:ze})}),e[90]=de,e[91]=ye,e[92]=ze,e[93]=We):We=e[93];let De;e[94]!==r||e[95]!==s||e[96]!==a||e[97]!==i||e[98]!==h||e[99]!==q?(De=r&&l.jsx(ae,{align:"center",flex:"none",gap:1,children:l.jsx(Ar,{canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:a,previewLocationRoute:q,initialUrl:i,perspective:h})}),e[94]=r,e[95]=s,e[96]=a,e[97]=i,e[98]=h,e[99]=q,e[100]=De):De=e[100];let Qe;return e[101]!==we||e[102]!==je||e[103]!==We||e[104]!==De||e[105]!==ne?(Qe=l.jsxs(ae,{align:"center",gap:1,paddingX:1,style:Q,children:[ne,we,je,We,De]}),e[101]=we,e[102]=je,e[103]=We,e[104]=De,e[105]=ne,e[106]=Qe):Qe=e[106],Qe};function Wa(t){var u;const e=W.c(7),r=Da,s=(u=t.options)==null?void 0:u.component;let a;e[0]!==s||e[1]!==t?(a=s?l.jsx(s,{...t,renderDefault:r}):r(t),e[0]=s,e[1]=t,e[2]=a):a=e[2];const n=a;let i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i={position:"relative"},e[3]=i):i=e[3];let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={minHeight:0},e[4]=o):o=e[4];let c;return e[5]!==n?(c=l.jsx(pe,{flex:"none",padding:2,borderBottom:!0,style:i,children:l.jsx(ae,{align:"center",style:o,children:n})}),e[5]=n,e[6]=c):c=e[6],c}function Da(t){return l.jsx(za,{...t})}function Na(t){return t.matches("loading")}function Fa(t){return t.matches("loaded")}function Va(t){return t.matches({loaded:"refreshing"})}function Ba(t){return t.matches({loaded:"reloading"})}function Ka(t){return t.context.visualEditingOverlaysEnabled}function Ha(t){return t.hasTag("busy")}const ht=Ge.create(ae),Ir=f.memo(f.forwardRef(function(t,e){const{header:r,initialUrl:s,loadersConnection:a,overlaysConnection:n,perspective:i,viewport:o,vercelProtectionBypass:c,presentationRef:u,previewUrlRef:m}=t,[d,p]=f.useState(null),h=Fe(d===null?i:d),b=f.useMemo(()=>{const $=new URL(s);return $.searchParams.get(Ne)||$.searchParams.set(Ne,h),(c||$.searchParams.get(Be))&&$.searchParams.set(Ct,"samesitenone"),c&&!$.searchParams.get(Be)&&$.searchParams.set(Be,c),$},[s,h,c]);f.useEffect(()=>{a==="connected"&&p($=>$===null?i:$)},[a,i]);const{t:w}=be(xe),{devMode:g}=$t(),v=an(),P=f.useRef(null),S=l.jsx(Wa,{...t,iframeRef:P,options:r});f.useImperativeHandle(e,()=>P.current);const y=te(u,$=>$.matches("loading")||$.matches({loaded:"reloading"})),[x,_]=f.useState(!1),T=te(u,$=>$.matches({loaded:"refreshing"})),[j,C]=f.useState(!1),R=y||T||n==="connecting",E=f.useCallback(()=>{P.current&&(P.current.src=b.toString(),u.send({type:"iframe reload"}))},[u,b]),U=f.useCallback(()=>{k(!0)},[]),[M,k]=f.useState(!1),[A,z]=f.useState(!1);f.useEffect(()=>{if(!(y||T)&&(n==="connecting"||n==="reconnecting")){const $=setTimeout(()=>{z(!0)},5e3);return()=>clearTimeout($)}},[n,y,T]),f.useEffect(()=>{if(!(y||T||!A)){if(n==="connected"&&(C(!1),z(!1),_(!1),k(!1)),n==="connecting"){const $=setTimeout(()=>{_(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},Nt);return()=>clearTimeout($)}if(n==="reconnecting"){const $=setTimeout(()=>{_(!0),C(!0)},Nt);return()=>clearTimeout($)}}},[y,n,T,A]);const D=f.useCallback(()=>{u.send({type:"iframe loaded"})},[u]),B=f.useMemo(()=>(y||n==="connecting"&&!T)&&!M,[M,y,T,n]),X=f.useSyncExternalStore(f.useCallback(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),ie=f.useMemo(()=>[B?"background":"active",y?"reloading":"idle",X?"":o,A&&!M?"timedOut":""],[X,M,y,B,A,o]),[q,G]=f.useState(o),[ue,Q]=f.useState(ft[o]);f.useEffect(()=>{if(X&&o!==q){const $=()=>{G(o),Q(ft[o])};!v&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition({update:()=>on.flushSync(()=>$()),types:["sanity-iframe-viewport"]}):$()}},[X,v,q,o]);const ne=st(),oe=Wt(m),[Y,ce]=f.useState(!1),[F]=f.useState(new Set),K=Ye($=>{if(oe.some(V=>V.test($))){ce($);return}F.has($)||(F.add($),console.warn("Visual Editing is here but misconfigured",{reportedOrigin:$}),ne.push({closable:!0,id:`presentation-iframe-origin-mismatch-${$}`,status:"error",duration:1/0,title:w("preview-frame.configuration.error.title"),description:l.jsx(Ut,{t:w,i18nKey:"preview-frame.configuration.error.description",components:{Code:"code"},values:{targetOrigin:b.origin,reportedOrigin:$}})}))}),H=cn(),J=Ye($=>{if(!Y)return;const V=new URL($,Y);H(`${Y}${V.pathname}${V.search}${V.hash}`)});return f.useEffect(()=>{var le;if(!Y)return;const $=(le=P.current)==null?void 0:le.contentWindow;if(!$)return;const V=ir({targetOrigin:Y});V.addTarget($);const N=V.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},bt().provide({actors:xt()}));N.on("visual-editing/navigate",me=>{J(me.url)});const Z=N.start();return()=>{Z(),V.destroy()}},[Y]),f.useEffect(()=>{if(n==="connecting"||n==="reconnecting"){const $=setInterval(()=>{var N,Z;(Z=(N=P.current)==null?void 0:N.contentWindow)==null||Z.postMessage({domain:"sanity/channels",from:"presentation",type:"presentation/status"},"*")},1e3),V=new AbortController;return window.addEventListener("message",({data:N})=>{N&&typeof N=="object"&&"domain"in N&&N.domain==="sanity/channels"&&"type"in N&&N.type==="visual-editing/status"&&"data"in N&&typeof N.data=="object"&&N.data&&"origin"in N.data&&typeof N.data.origin=="string"&&K(N.data.origin)},{signal:V.signal}),()=>{V.abort(),clearInterval($)}}},[n,x]),l.jsx(Hn,{transition:v?{duration:0}:void 0,children:l.jsxs(ln,{children:[S,l.jsx(pe,{flex:1,tone:"transparent",children:l.jsxs(ae,{align:"center",height:"fill",justify:"center",padding:(X?q:o)==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:R?"wait":void 0},children:[l.jsx(cr,{children:!j&&!y&&!T&&A&&!M?l.jsx(ht,{initial:"initial",animate:"animate",exit:"exit",variants:qt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:x?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:x?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:l.jsxs(ae,{style:{...rt[o]},justify:"center",align:"center",direction:"column",gap:4,children:[x&&l.jsx(Re,{disabled:!0,mode:"ghost",text:w("preview-frame.continue-button.text"),style:{opacity:0}}),l.jsx(pe,{radius:2,tone:x?"caution":"inherit",padding:4,shadow:1,children:l.jsxs(ae,{justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(Ze,{muted:!0}),l.jsx(re,{muted:!0,size:1,children:x?w("preview-frame.status",{context:"timeout"}):w("preview-frame.status",{context:"connecting"})})]})}),x&&l.jsx(Re,{tone:"critical",onClick:U,text:w("preview-frame.continue-button.text")})]})}):(y||n==="connecting"&&!T)&&!M?l.jsx(ht,{initial:"initial",animate:"animate",exit:"exit",variants:qt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:l.jsxs(ae,{style:{...rt[o]},justify:"center",align:"center",direction:"column",gap:4,children:[l.jsx(Ze,{muted:!0}),l.jsx(re,{muted:!0,size:1,children:w("preview-frame.status",{context:"loading"})})]})}):j&&!M?l.jsx(ht,{initial:"initial",animate:"animate",exit:"exit",variants:qa,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:l.jsx(zt,{flex:1,message:w("preview-frame.connection.error.text"),onRetry:E,onContinueAnyway:U,children:g&&l.jsxs(l.Fragment,{children:[n!=="connected"&&l.jsx(pe,{padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:w("preview-frame.overlay.connection-status.label")}),l.jsx(tt,{size:1,children:w("channel.status",{context:n})})]})}),a!=="connected"&&l.jsx(pe,{padding:3,radius:2,tone:"critical",children:l.jsxs(Ue,{space:3,children:[l.jsx(et,{muted:!0,size:0,children:w("preview-frame.loader.connection-status.label")}),l.jsx(tt,{size:1,children:w("channel.status",{context:a})})]})})]})})}):null}),l.jsx(_a,{animate:ie,initial:["background"],onLoad:D,preventClick:B,ref:P,src:b.toString(),style:ue,variants:ft})]})})]})})}));Ir.displayName="Memo(ForwardRef(Preview))";const rt={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},qt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},qa={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},ft={desktop:{...rt.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...rt.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function Ga(){let t=!1;return(...e)=>{t||(console.warn(...e),t=!0)}}const Xa=Ga();function Qa(t,e){const r=W.c(9);en(t);let s;r[0]===Symbol.for("react.memo_cache_sentinel")?(s={},r[0]=s):s=r[0];const[a,n]=f.useState(s);let i;r[1]===Symbol.for("react.memo_cache_sentinel")?(i={},r[1]=i):i=r[1];const[o,c]=f.useState(i),u=f.useRef("");let m;r[2]!==e?(m=(v,P,S)=>{const y=(S===void 0?[]:S).filter(Ya);(P==="published"?n:c)(x=>{const _={};for(const j of y)_[j._id]=j;if(u.current!==e.current.url)return u.current=e.current.url,{[v]:_};const T=x[v];return Kn(T,_)?x:{...x,[v]:_}})},r[2]=e,r[3]=m):m=r[3];const d=m;let p;const h=t==="published"?a:o;let b;if(r[4]!==h){const v=Object.values(h).reduce(Ja,{});b=Object.values(v),r[4]=h,r[5]=b}else b=r[5];p=b;const w=p;let g;return r[6]!==w||r[7]!==d?(g=[w,d],r[6]=w,r[7]=d,r[8]=g):g=r[8],g}function Ja(t,e){return Object.values(e).forEach(r=>{t[r._id]=r}),t}function Ya(t){return"_projectId"in t&&t._projectId?(Xa("Cross dataset references are not supported yet, ignoring source document",t),!1):t}function Mr(t,e){return t instanceof Function?t(e):t}function Za(t,e){var r;if(t.resolve){const s=(r=t.resolve(e))==null?void 0:r.filter;return s?`// groq
*[${s}][0]{_id, _type}`:void 0}return"type"in t?`// groq
*[_type == "${t.type}"][0]{_id, _type}`:`// groq
*[${Mr(t.filter,e)}][0]{_id, _type}`}function ei(t,e){var r;return t.resolve?((r=t.resolve(e))==null?void 0:r.params)??e.params:"type"in t?{}:Mr(t.params,e)??e.params}function ti(t,e){const r=Array.isArray(t)?t:[t];for(t of r){let s,a=t;if(typeof t=="string")try{const n=new URL(t);s=n.origin,a=n.pathname}catch{}if(!(s&&e.origin!==s))try{const n=gs(a,{decode:decodeURIComponent})(e.pathname);if(n){const{params:i,path:o}=n;return{origin:s,params:i,path:o}}}catch{throw new Error(`"${t}" is not a valid route pattern`)}}}function ri(t){var _,T;const e=W.c(22),{navigate:r,navigationHistory:s,path:a,targetOrigin:n,resolvers:i}=t;let o;e[0]!==i?(o=i===void 0?[]:i,e[0]=i,e[1]=o):o=e[1];const c=o,{state:u}=qe(),{perspectiveStack:m}=It();let d;e[2]===Symbol.for("react.memo_cache_sentinel")?(d={apiVersion:ot},e[2]=d):d=e[2];const p=nt(d);let h;e[3]!==a||e[4]!==u?(h=a||((T=(_=u._searchParams)==null?void 0:_.find(ni))==null?void 0:T[1])||"",e[3]=a,e[4]=u,e[5]=h):h=e[5];const b=h,[w,g]=f.useState(void 0),v=f.useRef(void 0);let P;e[6]!==r||e[7]!==s?(P=(j,C)=>{var R,E;(!j||v.current!==j._id)&&(g({document:j,path:C.pathname}),v.current=j==null?void 0:j._id,((R=s.at(-1))==null?void 0:R.id)===((E=s.at(-2))==null?void 0:E.id)&&(r==null||r({id:j==null?void 0:j._id,type:j==null?void 0:j._type})))},e[6]=r,e[7]=s,e[8]=P):P=e[8];const S=Ye(P);let y;e[9]!==p||e[10]!==S||e[11]!==m||e[12]!==b||e[13]!==c||e[14]!==n?(y=()=>{const j=new URL(b,n);if(c.length){let C;for(const R of c){const E=ti(R.route,j);if(E){C={context:E,resolver:R};break}}if(C){const R=Za(C.resolver,C.context),E=ei(C.resolver,C.context);if(R){const U=new AbortController,M={perspective:m,signal:U.signal,tag:"use-main-document"};return p.fetch(R,E,M).then(k=>S(k,j)).catch(k=>{k instanceof Error&&k.name==="AbortError"||(g({document:void 0,path:j.pathname}),v.current=void 0)}),()=>{U.abort()}}}}g(void 0),v.current=void 0},e[9]=p,e[10]=S,e[11]=m,e[12]=b,e[13]=c,e[14]=n,e[15]=y):y=e[15];let x;return e[16]!==p||e[17]!==m||e[18]!==b||e[19]!==c||e[20]!==n?(x=[p,m,b,c,n],e[16]=p,e[17]=m,e[18]=b,e[19]=c,e[20]=n,e[21]=x):x=e[21],f.useEffect(y,x),w}function ni(t){const[e]=t;return e==="preview"}const si=/^([\w-]+):(0|[1-9][0-9]*)$/,ai=/^([\w-]+):([0-9]+),([0-9]+)$/,ii=/^([\w-]+):([\w-]+)$/;function oi(t){const e=[];for(const r of t.split(".")){const s=si.exec(r);if(s){e.push(s[1],Number(s[2]));continue}const a=ai.exec(r);if(a){e.push(a[1],[Number(a[2]),Number(a[3])]);continue}const n=ii.exec(r);if(n){e.push(n[1],{_key:n[2]});continue}e.push(r)}return e}function ci(t){var r;if(t===void 0)return;const e=(r=decodeURIComponent(t))==null?void 0:r.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function li(t){if(t!==void 0)return or.toString(oi(decodeURIComponent(t)))}function ui(t){return{id:ci(t.id),path:li(t.path),type:t.type}}function Je(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}function di({initialPreviewUrl:t,routerNavigate:e,routerState:r,routerSearchParams:s,frameStateRef:a}){const n=f.useMemo(()=>{const{id:d,path:p,type:h}=ui(r);return{id:d,type:h,path:p,preview:s.preview||t.toString(),perspective:s.perspective,viewport:s.viewport,inspect:s.inspect,rev:s.rev,since:s.since,template:s.template,templateParams:s.templateParams,view:s.view,pathKey:s.pathKey,instruction:s.instruction,comment:s.comment,changesInspectorTab:s.changesInspectorTab}},[r,s,t]),i=f.useMemo(()=>Je({inspect:n.inspect,path:n.path,rev:n.rev,since:n.since,template:n.template,templateParams:n.templateParams,view:n.view,pathKey:n.pathKey,instruction:n.instruction,comment:n.comment,changesInspectorTab:n.changesInspectorTab}),[n.changesInspectorTab,n.comment,n.inspect,n.instruction,n.path,n.pathKey,n.rev,n.since,n.template,n.templateParams,n.view]),o=f.useMemo(()=>Je({perspective:n.perspective,preview:n.preview,viewport:n.viewport}),[n.perspective,n.preview,n.viewport]),c=f.useRef(r);f.useEffect(()=>{c.current=r},[r]);const[u,m]=f.useState([r]);return{navigate:f.useCallback((d,p={},h)=>{d.id&&(d.id=at(d.id));const{_searchParams:b,...w}=c.current,g=(b||[]).reduce((y,[x,_])=>(y[x]=_,y),{}),v=Je({...w,...d}),P=Je({...g,...p});w.id!==v.id&&(delete P.template,delete P.templateParams),v._searchParams=Object.entries(P).reduce((y,[x,_])=>[...y,[x,_]],[]);const S=h??P.preview===a.current.url;m(y=>[...y,v]),e(v,{replace:S})},[e,a]),navigationHistory:u,params:n,searchParams:o,structureParams:i}}const pi=t=>{const e=W.c(10),[r,s]=f.useState(mi);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=d=>{const p=window.open(d,"_blank");p&&s(h=>new Set(h).add(p))},e[0]=a):a=e[0];const n=a;let i,o;e[1]!==t||e[2]!==r?(i=()=>{const d=[];if(r.size&&t)for(const p of r)p&&"closed"in p&&!p.closed&&d.push(t.addTarget(p));return()=>{d.forEach(hi)}},o=[t,r],e[1]=t,e[2]=r,e[3]=i,e[4]=o):(i=e[3],o=e[4]),f.useEffect(i,o);let c,u;e[5]!==r?(c=()=>{if(r.size){const d=setInterval(()=>{const p=new Set;for(const h of r)h&&"closed"in h&&h.closed&&p.add(h);p.size&&s(h=>{const b=new Set(h);for(const w of p)b.delete(w);return b})},En);return()=>{clearInterval(d)}}},u=[r],e[5]=r,e[6]=c,e[7]=u):(c=e[6],u=e[7]),f.useEffect(c,u);let m;return e[8]!==r?(m={popups:r,open:n},e[8]=r,e[9]=m):m=e[9],m};function mi(){return new Set}function hi(t){return t()}function $r(){const{perspectiveStack:t,selectedPerspectiveName:e,selectedReleaseId:r}=It();return r?t:e===void 0?"drafts":e}function gt(){const t=W.c(4);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,t[0]=e):e=t[0];const[r,s]=f.useState(e);let a;e:{const u=Array.from(r.values());if(u.find(vi)){a="connected";break e}const m=u.filter(gi);if(m.length){a=m.some(fi)?"connecting":"reconnecting";break e}a="idle"}const n=a;let i;t[1]===Symbol.for("react.memo_cache_sentinel")?(i=u=>{s(m=>{var p;const d=new Map(m);if(u.status==="disconnected")d.delete(u.connection);else{const h=((p=d.get(u.connection))==null?void 0:p.hasConnected)||u.status==="connected",b=u.status==="handshaking"?"connecting":u.status;d.set(u.connection,{status:b,hasConnected:h})}return d})},t[1]=i):i=t[1];const o=i;let c;return t[2]!==n?(c=[n,o],t[2]=n,t[3]=c):c=t[3],c}function fi(t){const{hasConnected:e}=t;return!e}function gi(t){const{status:e}=t;return e==="connecting"}function vi(t){const{status:e}=t;return e==="connected"}const wi=f.lazy(()=>Ce(()=>import("./LiveQueries-Cph-vp_o.js"),__vite__mapDeps([2,1,3]))),yi=f.lazy(()=>Ce(()=>import("./PostMessageDocuments-OWvj-XH5.js"),__vite__mapDeps([4,1]))),bi=f.lazy(()=>Ce(()=>import("./PostMessageRefreshMutations-BtNeKtZK.js"),__vite__mapDeps([5,1]))),xi=f.lazy(()=>Ce(()=>import("./PostMessagePerspective-C26xHE66.js"),__vite__mapDeps([6,1]))),Pi=f.lazy(()=>Ce(()=>import("./PostMessagePreviewSnapshots-CQHVXI5c.js"),__vite__mapDeps([7,1]))),Si=f.lazy(()=>Ce(()=>import("./PostMessageSchema-Drz__zGm.js"),__vite__mapDeps([8,1]))),_i=f.lazy(()=>Ce(()=>import("./PostMessageTelemetry-7QbbMorF.js"),__vite__mapDeps([9,1]))),ji=ve(ae)`
  overflow-x: auto;
`;function Ei(t){var $e,Ee,Le;const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:r,tool:s,vercelProtectionBypass:a,initialPreviewUrl:n,previewUrlRef:i}=t,o=Wt(i),c=kr(i),u=($e=s.options)==null?void 0:$e.components,m=s.name||Hr,{unstable_navigator:d,unstable_header:p}=u||{},{navigate:h,state:b}=qe(),w=ar(Object.fromEntries(b._searchParams||[])),g=$r(),v=te(i,I=>{var O;return((O=I.context.previewMode)==null?void 0:O.shareAccess)!==!1}),[P]=f.useState(()=>{var O;const I=(O=s.options)==null?void 0:O.devMode;return typeof I=="function"?I():typeof I=="boolean"?I:typeof window<"u"&&window.location.hostname==="localhost"}),S=f.useRef(null),[y,x]=f.useState(),[_,T]=f.useState(null),j=f.useRef({title:void 0,url:void 0}),{navigate:C,navigationHistory:R,params:E,searchParams:U,structureParams:M}=di({initialPreviewUrl:n,routerNavigate:h,routerState:b,routerSearchParams:w,frameStateRef:j}),k=f.useMemo(()=>Sr(C,50),[C]),A=sr(Rs),z=f.useMemo(()=>E.viewport?"mobile":"desktop",[E.viewport]),[D,B]=Qa(g,j),X=qr(),ie=Gr(),q=ri({navigate:C,navigationHistory:R,path:E.preview,targetOrigin:c,resolvers:(Le=(Ee=s.options)==null?void 0:Ee.resolve)==null?void 0:Le.mainDocuments}),[G,ue]=gt(),[Q,ne]=gt(),[oe,Y]=gt(),{open:ce}=pi(y),F=te(A,I=>I.matches("loading"));f.useEffect(()=>{var L;const I=(L=S.current)==null?void 0:L.contentWindow;if(!I||F)return;const O=ir({targetOrigin:c});return O.addTarget(I),x(O),()=>{O.destroy(),x(void 0)}},[c,F]);const K=Ye((I,O,L)=>k(I,O,L));f.useEffect(()=>{if(!y)return;const I=y.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},bt().provide({actors:xt()}));I.on("visual-editing/focus",L=>{"id"in L&&K({type:L.type,id:L.id,path:L.path})}),I.on("visual-editing/navigate",L=>{const{title:je}=L;let de=L.url;if(!de.startsWith("http"))try{de=new URL(de,c).toString()}catch{}if(j.current.url!==de)try{const[Ve,Ie]=de.split("?"),ye=new URLSearchParams(Ie);ye.delete(Be),ye.delete(Ct),K({},{preview:`${Ve}${ye.size>0?"?":""}${ye}`})}catch{K({},{preview:de})}j.current={title:je,url:de}}),I.on("visual-editing/meta",L=>{j.current.title=L.title}),I.on("visual-editing/toggle",L=>{A.send({type:"toggle visual editing overlays",enabled:L.enabled})}),I.on("visual-editing/documents",L=>{B("visual-editing",L.perspective,L.documents)}),I.on("visual-editing/refreshing",L=>{L.source==="manual"?clearTimeout(fe.current):L.source==="mutation"&&A.send({type:"iframe refresh"})}),I.on("visual-editing/refreshed",()=>{A.send({type:"iframe loaded"})}),I.onStatus(ue);const O=I.start();return T(I),()=>{O(),T(null)}},[y,A,B,ue,c]),f.useEffect(()=>{if(!y)return;const I=y.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},bt().provide({actors:xt()}));return I.onStatus(Y),I.on("preview-kit/documents",O=>{O.projectId===X&&O.dataset===ie&&B("preview-kit",O.perspective,O.documents)}),I.start()},[y,ie,X,B,Y,c]);const H=f.useCallback(I=>{k({path:or.toString(I)},{},!0)},[k]),J=f.useCallback(I=>{const O=new URL(I,c),L=O.toString();E.preview!==L&&(Array.isArray(o)?o.some(je=>je.test(L))&&k({},{preview:L}):O.origin===c&&k({},{preview:L}))},[c,E.preview,o,k]),$=f.useCallback(I=>{k({},I)},[k]);f.useEffect(()=>{E.id&&E.path?_==null||_.post("presentation/focus",{id:E.id,path:E.path}):_==null||_.post("presentation/blur")},[E.id,E.path,_]),f.useEffect(()=>{if(j.current.url&&E.preview&&j.current.url!==E.preview){try{const I=new URL(j.current.url,c).origin,O=new URL(E.preview,c).origin;if(I!==O)return}catch{}if(j.current.url=E.preview,G==="connected"){let I=E.preview;if(I.startsWith("http"))try{const O=new URL(E.preview,c);I=O.pathname+O.search+O.hash}catch{}_==null||_.post("presentation/navigate",{url:I,type:"replace"})}}},[G,c,E.preview,_]);const V=f.useCallback(()=>_==null?void 0:_.post("presentation/toggle-overlay"),[_]),[N,Z]=f.useState(null);f.useEffect(()=>{const I=L=>{Gt(L)&&V()},O=L=>{Gt(L)&&V(),Ci(["mod","\\"],L)&&V()};return window.addEventListener("keydown",O),window.addEventListener("keyup",I),()=>{window.removeEventListener("keydown",O),window.removeEventListener("keyup",I)}},[V]);const[le,me]=f.useState(null),[{navigatorEnabled:Te,toggleNavigator:Pe},Se]=va({unstable_navigator:d}),fe=f.useRef(void 0),_e=f.useCallback(I=>{if(A.send({type:"iframe refresh"}),_){fe.current=window.setTimeout(I,300),_.post("presentation/refresh",{source:"manual",livePreviewEnabled:oe==="connected"||Q==="connected"});return}I()},[Q,A,oe,_]),we=Xr(),ke=f.useCallback(({id:I,type:O,path:L})=>{if(j.current.url)return{title:j.current.title||j.current.url,name:"edit",params:{id:I,path:L,type:O,inspect:Jr,workspace:we.name,mode:Qr,preview:E.preview}}},[E.preview,we.name]),Ae=f.useCallback(I=>{k({},{viewport:I==="desktop"?void 0:"mobile"},!0)},[k]);return l.jsxs(l.Fragment,{children:[l.jsx(Pa,{devMode:P,name:m,navigate:k,params:E,searchParams:U,structureParams:M,children:l.jsx(fa,{navigate:k,children:l.jsx(xa,{params:E,children:l.jsx(Cs,{comlink:_,children:l.jsx(ji,{"data-testid":"presentation-root",height:"fill",children:l.jsxs(Ws,{children:[l.jsx(Se,{}),l.jsx(Ot,{id:"preview",minWidth:325,defaultSize:Te?50:75,order:3,children:l.jsx(ae,{direction:"column",flex:1,height:"fill",ref:me,children:l.jsx(Yr,{element:le,children:l.jsx(Ir,{canSharePreviewAccess:v,canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:r,header:p,initialUrl:n,loadersConnection:Q,navigatorEnabled:Te,onPathChange:J,onRefresh:_e,openPopup:ce,overlaysConnection:G,previewUrl:E.preview,perspective:g,ref:S,setViewport:Ae,targetOrigin:c,toggleNavigator:Pe,toggleOverlay:V,viewport:z,vercelProtectionBypass:a,presentationRef:A,previewUrlRef:i},c)})})}),l.jsx(ha,{documentId:E.id,documentsOnPage:D,documentType:E.type,getCommentIntent:ke,mainDocumentState:q,onFocusPath:H,onStructureParams:$,searchParams:U,setDisplayedDocument:Z,structureParams:M})]})})})})})}),l.jsxs(f.Suspense,{children:[y&&l.jsx(wi,{controller:y,perspective:g,liveDocument:N,onDocumentsOnPage:B,onLoadersConnection:ne}),_&&E.id&&E.type&&l.jsx(bi,{comlink:_,id:E.id,type:E.type,loadersConnection:Q,previewKitConnection:oe}),_&&l.jsx(Si,{comlink:_,perspective:g}),_&&D.length>0&&l.jsx(Pi,{comlink:_,perspective:g,refs:D}),_&&l.jsx(yi,{comlink:_,perspective:g}),_&&l.jsx(js,{comlink:_}),_&&l.jsx(xi,{comlink:_,perspective:g}),_&&l.jsx(_i,{comlink:_})]})]})}function Gt(t){return t.key==="Alt"}const Ri=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Xt={alt:"altKey",ctrl:"ctrlKey",mod:Ri?"metaKey":"ctrlKey",shift:"shiftKey"};function Ci(t,e){return t.every(r=>Xt[r]?e[Xt[r]]:e.key===r.toUpperCase())}function Ti({client:t,currentUserId:e}){return he(async()=>await Ps(t,"sanity/presentation",location.href,e))}function ki({client:t}){return he(async()=>t.fetch(ur,{},{tag:"presentation.fallback-to-shared-access-secret"}))}function Ai({client:t,allowOption:e}){return he(async({input:r})=>{const{initialUrl:s}=r;if(typeof URLPattern>"u"&&await Ce(()=>import("./index-CEBgaQ5I.js"),[]),!e)return[new URLPattern(s.origin)];const a=typeof e=="function"?await e({client:t,origin,initialUrl:s}):e,n=(Array.isArray(a)?a:[a]).map(i=>{const o=new URLPattern(i);if(o.hostname==="*")throw new Error("It's insecure to allow any hostname, it could disclose data to a malicious site");return o});return n.some(i=>i.test(s.origin))?n:[...n,new URLPattern(s.origin)]})}function Ii({client:t,studioBasePath:e,previewUrlOption:r,perspective:s}){return he(async({input:a})=>{const{origin:n}=location;if(typeof r=="function"){const i=await r({client:t,studioBasePath:e,previewUrlSecret:"",studioPreviewPerspective:Fe(s),previewSearchParam:a.previewSearchParam});return new URL(i,n)}if(!r)return new URL("/",n);if(typeof r=="string")return new URL(r,n);if(typeof r.initial=="function"){const i=await r.initial({client:t,origin:n});return new URL(i,n)}return typeof r.initial=="string"?new URL(r.initial,n):new URL(r.preview||"/",r.origin||n)})}function Mi({client:t,previewUrlOption:e}){return he(async({input:r})=>{const{targetOrigin:s}=r;if(typeof e=="object"&&(e!=null&&e.draftMode))return{enable:e.draftMode.enable,shareAccess:e.draftMode.shareAccess??!0};if(!e||typeof e=="string"||typeof e=="function"||!e.previewMode)return!1;const a=typeof e.previewMode=="function"?await e.previewMode({client:t,origin,targetOrigin:s}):e.previewMode;return a===!1?!1:{enable:a.enable,shareAccess:a.shareAccess??!0}})}function $i({client:t,studioBasePath:e,previewUrlOption:r,perspective:s}){return he(async({input:a})=>{const{previewUrlSecret:n,resolvedPreviewMode:i,initialUrl:o}=a;if(typeof r=="function"){const u=await r({client:t,studioBasePath:e,previewUrlSecret:n,studioPreviewPerspective:Fe(s),previewSearchParam:o.toString()});return new URL(u,o)}if(!i)throw new Error("Resolved preview mode is false");const c=new URL(i.enable,o);return c.searchParams.set(Rt,n),c.searchParams.set(Ne,Fe(s)),o.pathname!==c.pathname&&c.searchParams.set(Et,`${o.pathname}${o.search}${o.hash}`),c})}const Ui=he(async({input:t})=>{const{previewSearchParam:e,initialUrl:r,allowOrigins:s}=t;if(!e)return r;try{const a=new URL(e,r.origin);return s.some(n=>n.test(a.origin))?a:r}catch{return r}}),vt={_id:He,_type:kt},Li={_id:`drafts.${Yt()}`,_type:Zt},Oi=_t({actions:{"notify preview will likely fail":Zr("Missing permissions to create preview secret, or read shared preview secret. Preview will likely fail loading."),"assign preview search param":ee({previewSearchParam:(t,e)=>e.previewSearchParam}),"assign error":ee({error:(t,e)=>e.error instanceof Error?e.error:new Error(e.message,{cause:e.error})})},actors:{"check permission":nr(()=>Fn(()=>new Error("The 'check permission' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'check permission': fromObservable(({input}: {input: CheckPermissionInput}) => ...)}})"))),"resolve initial url":he(()=>Promise.reject(new Error("The 'resolve initial url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve initial url': fromPromise(...)}})"))),"resolve allow patterns":he(()=>Promise.reject(new Error("The 'resolve allow patterns' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve allow pattern': fromPromise(...)}})"))),"resolve url from preview search param":Ui,"resolve preview mode":he(()=>Promise.reject(new Error("The 'resolve preview mode' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode': fromPromise(...)}})"))),"create preview secret":he(async()=>Promise.reject(new Error("The 'create preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'create preview secret': fromPromise(...)}})"))),"read shared preview secret":he(async()=>Promise.reject(new Error("The 'read shared preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'read shared preview secret': fromPromise(...)}})"))),"resolve preview mode url":he(()=>Promise.reject(new Error("The 'resolve preview mode url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode url': fromPromise(...)}})")))},guards:{"has checked permissions":({context:t})=>!!(t.previewAccessSharingCreatePermission&&t.previewAccessSharingReadPermission&&t.previewAccessSharingUpdatePermission&&t.previewUrlSecretPermission),"search param has new origin":({context:t,event:e})=>{if(!t.previewUrl||!e.previewSearchParam)return!1;try{const r=new URL(e.previewSearchParam,t.previewUrl);return t.previewUrl.origin!==r.origin}catch{return!1}},"can create preview secret":({context:t})=>{var e;return((e=t.previewUrlSecretPermission)==null?void 0:e.granted)===!0},"has preview mode with created secret":({context:t},e)=>{var r;return e===!1?!1:((r=t.previewUrlSecretPermission)==null?void 0:r.granted)===!0},"has preview mode with share access":({context:t},e)=>{var r;return e===!1?!1:((r=t.previewAccessSharingReadPermission)==null?void 0:r.granted)===!0},"has preview mode without permissions":({context:t},e)=>{var r,s;return e===!1?!1:((r=t.previewAccessSharingReadPermission)==null?void 0:r.granted)===!1&&((s=t.previewUrlSecretPermission)==null?void 0:s.granted)===!1}},delays:{expiredSecret:({context:t})=>{var s;if(!((s=t.previewUrlSecret)!=null&&s.expiresAt))return 0;const e=Date.now(),r=t.previewUrlSecret.expiresAt.getTime();return Math.max(r-e,0)}}}).createMachine({id:"Preview URL",context:({input:t})=>({initialUrl:null,previewUrl:null,error:null,allowOrigins:null,previewSearchParam:t.previewSearchParam,previewUrlSecret:null,previewAccessSharingCreatePermission:null,previewAccessSharingReadPermission:null,previewAccessSharingUpdatePermission:null,previewUrlSecretPermission:null,previewMode:null}),invoke:[{src:"check permission",input:()=>({checkPermissionName:"read",document:vt}),onError:{target:".error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to check permission",error:t.error})}},onSnapshot:{actions:ee({previewAccessSharingReadPermission:({event:t})=>t.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:vt}),onError:{target:".error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to check permission",error:t.error})}},onSnapshot:{actions:ee({previewAccessSharingCreatePermission:({event:t})=>t.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"update",document:vt}),onError:{target:".error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to check permission",error:t.error})}},onSnapshot:{actions:ee({previewAccessSharingUpdatePermission:({event:t})=>t.snapshot.context??null})}},{src:"check permission",input:()=>({checkPermissionName:"create",document:Li}),onError:{target:".error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to check permission",error:t.error})}},onSnapshot:{actions:ee({previewUrlSecretPermission:({event:t})=>t.snapshot.context??null})}}],on:{"set preview search param":{actions:{type:"assign preview search param",params:({event:t})=>({previewSearchParam:t.previewSearchParam})}}},states:{checkingPermissions:{always:{guard:"has checked permissions",target:"resolvingInitialUrl"},tags:"busy"},resolvingInitialUrl:{invoke:{src:"resolve initial url",input:({context:t})=>({previewSearchParam:t.previewSearchParam}),onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to resolve initial url",error:t.error})}},onDone:{target:"resolvingAllowPatterns",actions:ee({initialUrl:({event:t})=>t.output})}},tags:"busy"},error:{type:"final",tags:"error"},resolvingAllowPatterns:{invoke:{src:"resolve allow patterns",input:({context:t})=>({initialUrl:t.initialUrl}),onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to resolve preview url allow patterns",error:t.error})}},onDone:{target:"resolvingUrlFromPreviewSearchParam",actions:ee({allowOrigins:({event:t})=>t.output})}},tags:["busy"]},resolvingUrlFromPreviewSearchParam:{id:"loop",invoke:{src:"resolve url from preview search param",input:({context:t})=>({initialUrl:t.initialUrl,allowOrigins:t.allowOrigins,previewSearchParam:t.previewSearchParam}),onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to resolve preview url from search param",error:t.error})}},onDone:{target:"resolvingPreviewMode",actions:ee({initialUrl:({event:t})=>t.output})}},tags:["busy"]},resolvingPreviewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:t})=>({previewSearchParam:t.previewSearchParam})},target:"#loop",reenter:!0}},invoke:{src:"resolve preview mode",input:({context:t})=>({targetOrigin:t.initialUrl.origin}),onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to resolve preview url allow patterns",error:t.error})}},onDone:[{guard:{type:"has preview mode with created secret",params:({event:t})=>t.output},actions:ee({previewMode:({event:t})=>t.output}),target:"previewMode.createPreviewSecret"},{guard:{type:"has preview mode with share access",params:({event:t})=>t.output},actions:ee({previewMode:({event:t})=>t.output}),target:"previewMode.readShareAccess"},{guard:{type:"has preview mode without permissions",params:({event:t})=>t.output},actions:[ee({previewUrl:({context:t})=>t.initialUrl}),"notify preview will likely fail"],target:"success"},{actions:ee({previewUrl:({context:t})=>t.initialUrl}),target:"success"}]},tags:["busy"]},success:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:t})=>({previewSearchParam:t.previewSearchParam})},target:"#loop",reenter:!0}}},previewMode:{on:{"set preview search param":{guard:"search param has new origin",actions:{type:"assign preview search param",params:({event:t})=>({previewSearchParam:t.previewSearchParam})},target:"#loop",reenter:!0}},states:{createPreviewSecret:{invoke:{src:"create preview secret",onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to create preview secret",error:t.error})}},onDone:{target:"resolvePreviewUrl",actions:ee({previewUrlSecret:({event:t})=>t.output})}},tags:["busy"]},readShareAccess:{invoke:{src:"read shared preview secret",onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to read shared preview secret",error:t.error})}},onDone:{target:"resolvePreviewUrl",actions:ee({previewUrlSecret:({event:t})=>({secret:t.output,expiresAt:new Date(Date.now()+1e3*60*60*60*24)})})}},tags:["busy"]},resolvePreviewUrl:{invoke:{src:"resolve preview mode url",input:({context:t})=>({initialUrl:t.initialUrl,resolvedPreviewMode:t.previewMode,previewUrlSecret:t.previewUrlSecret.secret}),onError:{target:"error",actions:{type:"assign error",params:({event:t})=>({message:"Failed to resolve preview url",error:t.error})}},onDone:{target:"success",actions:ee({previewUrl:({event:t})=>t.output})}},tags:["busy"]},error:{type:"final",tags:["error"]},success:{after:{expiredSecret:{guard:"can create preview secret",actions:ee({previewUrlSecret:null}),target:"createPreviewSecret",reenter:!0}}}},initial:"readShareAccess"}},initial:"checkingPermissions"});function zi(t,e){var y,x,_;const r=W.c(24),s=Kr();let a;r[0]===Symbol.for("react.memo_cache_sentinel")?(a={apiVersion:ot},r[0]=a):a=r[0];const n=nt(a),i=(y=tr())==null?void 0:y.id,o=((_=(x=rr())==null?void 0:x.activeWorkspace)==null?void 0:_.basePath)||"/",c=qe();let u;r[1]!==c.state._searchParams?(u=new URLSearchParams(c.state._searchParams).get("preview"),r[1]=c.state._searchParams,r[2]=u):u=r[2];const m=u,{push:d}=st(),{t:p}=be(xe),h=$r();let b;if(r[3]!==e||r[4]!==n||r[5]!==i||r[6]!==s||r[7]!==h||r[8]!==t||r[9]!==d||r[10]!==o||r[11]!==p){let T;r[13]!==d||r[14]!==p?(T=()=>d({id:"preview-url-secret.missing-grants",closable:!0,status:"error",duration:1/0,title:p("preview-url-secret.missing-grants")}),r[13]=d,r[14]=p,r[15]=T):T=r[15];let j;r[16]!==s?(j=C=>{const{input:R}=C;return s.checkDocumentPermission(R.checkPermissionName,R.document)},r[16]=s,r[17]=j):j=r[17],b=Oi.provide({actions:{"notify preview will likely fail":T},actors:{"create preview secret":Ti({client:n,currentUserId:i}),"read shared preview secret":ki({client:n}),"resolve allow patterns":Ai({client:n,allowOption:e}),"resolve initial url":Ii({client:n,studioBasePath:o,previewUrlOption:t,perspective:h}),"resolve preview mode":Mi({client:n,previewUrlOption:t}),"resolve preview mode url":$i({client:n,studioBasePath:o,previewUrlOption:t,perspective:h}),"check permission":nr(j)}}),r[3]=e,r[4]=n,r[5]=i,r[6]=s,r[7]=h,r[8]=t,r[9]=d,r[10]=o,r[11]=p,r[12]=b}else b=r[12];let w;r[18]!==m?(w={input:{previewSearchParam:m}},r[18]=m,r[19]=w):w=r[19];const g=sr(b,w);let v,P;r[20]!==g||r[21]!==m?(v=()=>{g.send({type:"set preview search param",previewSearchParam:m})},P=[g,m],r[20]=g,r[21]=m,r[22]=v,r[23]=P):(v=r[22],P=r[23]),f.useEffect(v,P);const S=te(g,Wi);if(S)throw S;return g}function Wi(t){return t.status==="error"?t.error:t.hasTag("error")?t.context.error:null}function Di(t){const e=W.c(9),{t:r}=be(xe),{push:s}=st(),a=qe();let n;e[0]!==a.state._searchParams?(n=new URLSearchParams(a.state._searchParams).get("preview"),e[0]=a.state._searchParams,e[1]=n):n=e[1];const i=n,o=te(t,Fi),c=te(t,Ni);let u,m;e[2]!==o||e[3]!==c||e[4]!==i||e[5]!==s||e[6]!==r?(u=()=>{if(!Array.isArray(o)||!i||!c)return;const d=new URL(i,c).origin;o.some(p=>p.test(d))||s({closable:!0,id:`presentation-iframe-origin-mismatch-${d}`,status:"error",duration:1/0,title:r("preview-search-param.configuration.error.title"),description:l.jsx(Ut,{t:r,i18nKey:"preview-search-param.configuration.error.description",components:{Code:"code"},values:{previewSearchParam:i,blockedOrigin:d}})})},m=[o,c,i,s,r],e[2]=o,e[3]=c,e[4]=i,e[5]=s,e[6]=r,e[7]=u,e[8]=m):(u=e[7],m=e[8]),f.useEffect(u,m)}function Ni(t){var e;return(e=t.context.previewUrl)==null?void 0:e.origin}function Fi(t){return t.context.allowOrigins}function Vi(){const t=W.c(7);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={apiVersion:ot},t[0]=e):e=t[0];const r=nt(e),[s,a]=f.useReducer(Bi,"loading"),[n,i]=f.useState(null);let o,c;t[1]!==r?(o=()=>{const m=Ss(r,d=>{i(d),a()});return()=>m()},c=[r],t[1]=r,t[2]=o,t[3]=c):(o=t[2],c=t[3]),f.useEffect(o,c);let u;return t[4]!==s||t[5]!==n?(u=[n,s],t[4]=s,t[5]=n,t[6]=u):u=t[6],u}function Bi(){return"ready"}function Ki(t){var b,w;const e=W.c(8),{tool:r}=t,s=zi((b=r.options)==null?void 0:b.previewUrl,(w=r.options)==null?void 0:w.allowOrigins);Di(s);const a=te(s,Qi),n=te(s,Xi),i=te(s,Gi),o=te(s,qi),c=te(s,Hi),[u,m]=Vi();if(!c||m==="loading"||!a||typeof a.granted>"u"||!n||typeof n.granted>"u"||!o||!i||typeof i.granted>"u"||typeof o.granted>"u"){let g;return e[0]===Symbol.for("react.memo_cache_sentinel")?(g=l.jsx(er,{}),e[0]=g):g=e[0],g}const d=(a==null?void 0:a.granted)===!0&&(n==null?void 0:n.granted)===!0,p=(i==null?void 0:i.granted)===!0;let h;return e[1]!==s||e[2]!==d||e[3]!==p||e[4]!==r||e[5]!==c||e[6]!==u?(h=l.jsx(Ei,{tool:r,initialPreviewUrl:c,vercelProtectionBypass:u,canToggleSharePreviewAccess:d,canUseSharedPreviewAccess:p,previewUrlRef:s}),e[1]=s,e[2]=d,e[3]=p,e[4]=r,e[5]=c,e[6]=u,e[7]=h):h=e[7],h}function Hi(t){return t.context.previewUrl}function qi(t){return t.context.previewUrlSecretPermission}function Gi(t){return t.context.previewAccessSharingReadPermission}function Xi(t){return t.context.previewAccessSharingUpdatePermission}function Qi(t){return t.context.previewAccessSharingCreatePermission}const Zi=Object.freeze(Object.defineProperty({__proto__:null,default:Ki},Symbol.toStringTag,{value:"Module"}));export{Zi as P,xt as c};
